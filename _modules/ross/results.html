<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ross.results &#8212; ross 1.0.0rc1 documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../../_static/ross-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/ross-logo.svg"></span>
          ROSS</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../tutorials.html">Tutorial</a></li>
                <li><a href="../../examples.html">Examples</a></li>
                <li><a href="../../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#install-python">Install Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#install-ross">Install ROSS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tutorial_part_1.html">Tutorial - Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tutorial_part_2.html">Tutorial - Running Analyzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/tutorial_part_3.html">Tutorial - Stochastic ROSS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#ross-examples">ROSS Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#fluidflow-examples">FluidFlow Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#stochastic-ross-examples">Stochastic ROSS Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../download.html">Download notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#material">Material</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#elements">Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#rotor-and-results">Rotor and Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#results">Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#feedback-and-contribution">Feedback and Contribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#code-style-black">Code style: Black</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#how-to-contribute-to-ross-using-git">How to contribute to ROSS using git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing.html#making-new-releases">Making new releases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes.html#version-0-4-0">Version 0.4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes.html#version-0-3-0">Version 0.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes.html#version-0-2-0-beta-release">Version 0.2.0 (beta release)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../release_notes.html#version-0-1-0-alpha-release">Version 0.1.0 (alpha release)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for ross.results</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;ROSS plotting module.</span>

<span class="sd">This module returns graphs for each type of analyses in rotor_assembly.py.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">toml</span>
<span class="kn">from</span> <span class="nn">plotly</span> <span class="kn">import</span> <span class="n">graph_objects</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>

<span class="kn">from</span> <span class="nn">ross.plotly_theme</span> <span class="kn">import</span> <span class="n">tableau_colors</span>
<span class="kn">from</span> <span class="nn">ross.units</span> <span class="kn">import</span> <span class="n">Q_</span>
<span class="kn">from</span> <span class="nn">ross.utils</span> <span class="kn">import</span> <span class="n">intersection</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;CriticalSpeedResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ModalResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CampbellResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FrequencyResponseResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ForcedResponseResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StaticResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SummaryResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ConvergenceResults&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TimeResponseResults&quot;</span><span class="p">,</span>
<span class="p">]</span>


<span class="k">class</span> <span class="nc">Results</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Results class.</span>

<span class="sd">    This class is a general abstract class to be implemented in other classes</span>
<span class="sd">    for post-processing results, in order to add saving and loading data options.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save results in a .toml file.</span>

<span class="sd">        This function will save the simulation results to a .toml file.</span>
<span class="sd">        The file will have all the argument&#39;s names and values that are needed to</span>
<span class="sd">        reinstantiate the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str, pathlib.Path</span>
<span class="sd">            The name of the file the results will be saved in.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; # Example running a unbalance response</span>
<span class="sd">        &gt;&gt;&gt; from tempfile import tempdir</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; import ross as rs</span>

<span class="sd">        &gt;&gt;&gt; # Running an example</span>
<span class="sd">        &gt;&gt;&gt; rotor = rs.rotor_example()</span>
<span class="sd">        &gt;&gt;&gt; speed = np.linspace(0, 1000, 101)</span>
<span class="sd">        &gt;&gt;&gt; response = rotor.run_unbalance_response(node=3,</span>
<span class="sd">        ...                                         unbalance_magnitude=0.001,</span>
<span class="sd">        ...                                         unbalance_phase=0.0,</span>
<span class="sd">        ...                                         frequency=speed)</span>

<span class="sd">        &gt;&gt;&gt; # create path for a temporary file</span>
<span class="sd">        &gt;&gt;&gt; file = Path(tempdir) / &#39;unb_resp.toml&#39;</span>
<span class="sd">        &gt;&gt;&gt; response.save(file)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get __init__ arguments</span>
        <span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span>
        <span class="n">args_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">signature</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="n">arg</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args_list</span><span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">args</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">toml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">encoder</span><span class="o">=</span><span class="n">toml</span><span class="o">.</span><span class="n">TomlNumpyEncoder</span><span class="p">())</span>

        <span class="k">if</span> <span class="s2">&quot;rotor&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">aux_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_rotor&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
            <span class="n">args</span><span class="p">[</span><span class="s2">&quot;rotor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">aux_file</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">read_toml_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read and parse data stored in a .toml file.</span>

<span class="sd">        The data passed to this method needs to be according to the</span>
<span class="sd">        format saved in the .toml file by the .save() method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : dict</span>
<span class="sd">            Dictionary obtained from toml.load().</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The result object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load results from a .toml file.</span>

<span class="sd">        This function will load the simulation results from a .toml file.</span>
<span class="sd">        The file must have all the argument&#39;s names and values that are needed to</span>
<span class="sd">        reinstantiate the class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file : str, pathlib.Path</span>
<span class="sd">            The name of the file the results will be loaded from.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; # Example running a stochastic unbalance response</span>
<span class="sd">        &gt;&gt;&gt; from tempfile import tempdir</span>
<span class="sd">        &gt;&gt;&gt; from pathlib import Path</span>
<span class="sd">        &gt;&gt;&gt; import ross as rs</span>

<span class="sd">        &gt;&gt;&gt; # Running an example</span>
<span class="sd">        &gt;&gt;&gt; rotor = rs.rotor_example()</span>
<span class="sd">        &gt;&gt;&gt; freq_range = np.linspace(0, 500, 31)</span>
<span class="sd">        &gt;&gt;&gt; n = 3</span>
<span class="sd">        &gt;&gt;&gt; m = 0.01</span>
<span class="sd">        &gt;&gt;&gt; p = 0.0</span>
<span class="sd">        &gt;&gt;&gt; results = rotor.run_unbalance_response(n, m, p, freq_range)</span>

<span class="sd">        &gt;&gt;&gt; # create path for a temporary file</span>
<span class="sd">        &gt;&gt;&gt; file = Path(tempdir) / &#39;unb_resp.toml&#39;</span>
<span class="sd">        &gt;&gt;&gt; results.save(file)</span>

<span class="sd">        &gt;&gt;&gt; # Loading file</span>
<span class="sd">        &gt;&gt;&gt; results2 = rs.ForcedResponseResults.load(file)</span>
<span class="sd">        &gt;&gt;&gt; abs(results2.forced_resp).all() == abs(results.forced_resp).all()</span>
<span class="sd">        True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">str_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;U4</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;rotor&quot;</span><span class="p">:</span>
                <span class="n">aux_file</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_rotor&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
                <span class="kn">from</span> <span class="nn">ross.rotor_assembly</span> <span class="kn">import</span> <span class="n">Rotor</span>

                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rotor</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">aux_file</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">in</span> <span class="n">str_type</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">read_toml_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


<div class="viewcode-block" id="CriticalSpeedResults"><a class="viewcode-back" href="../../generated/results/ross.CriticalSpeedResults.html#ross.CriticalSpeedResults">[docs]</a><span class="k">class</span> <span class="nc">CriticalSpeedResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results from run_critical_speed() method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    _wn : array</span>
<span class="sd">        Undamped critical speeds array.</span>
<span class="sd">    _wd : array</span>
<span class="sd">        Undamped critical speeds array.</span>
<span class="sd">    log_dec : array</span>
<span class="sd">        Logarithmic decrement for each critical speed.</span>
<span class="sd">    damping_ratio : array</span>
<span class="sd">        Damping ratio for each critical speed.</span>
<span class="sd">    whirl_direction : array</span>
<span class="sd">        Whirl direction for each critical speed. Can be forward, backward or mixed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CriticalSpeedResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.CriticalSpeedResults.html#ross.CriticalSpeedResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_wn</span><span class="p">,</span> <span class="n">_wd</span><span class="p">,</span> <span class="n">log_dec</span><span class="p">,</span> <span class="n">damping_ratio</span><span class="p">,</span> <span class="n">whirl_direction</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wn</span> <span class="o">=</span> <span class="n">_wn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wd</span> <span class="o">=</span> <span class="n">_wd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span> <span class="o">=</span> <span class="n">log_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">damping_ratio</span> <span class="o">=</span> <span class="n">damping_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">whirl_direction</span> <span class="o">=</span> <span class="n">whirl_direction</span></div>

<div class="viewcode-block" id="CriticalSpeedResults.wn"><a class="viewcode-back" href="../../generated/results/ross.CriticalSpeedResults.html#ross.CriticalSpeedResults.wn">[docs]</a>    <span class="k">def</span> <span class="nf">wn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert units for undamped critical speeds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Critical speeds units.</span>
<span class="sd">            Default is rad/s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wn : array</span>
<span class="sd">            Undamped critical speeds array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_wn&quot;</span><span class="p">],</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span></div>

<div class="viewcode-block" id="CriticalSpeedResults.wd"><a class="viewcode-back" href="../../generated/results/ross.CriticalSpeedResults.html#ross.CriticalSpeedResults.wd">[docs]</a>    <span class="k">def</span> <span class="nf">wd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert units for damped critical speeds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Critical speeds units.</span>
<span class="sd">            Default is rad/s</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        wd : array</span>
<span class="sd">            Undamped critical speeds array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s2">&quot;_wd&quot;</span><span class="p">],</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span></div></div>


<div class="viewcode-block" id="ModalResults"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults">[docs]</a><span class="k">class</span> <span class="nc">ModalResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Modal Analysis.</span>

<span class="sd">    Two options for plottting are available: plot_mode3D (mode shape 3D view)</span>
<span class="sd">    and plot_mode2D (mode shape 2D view). The user chooses between them using</span>
<span class="sd">    the respective methods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    speed : float</span>
<span class="sd">        Rotor speed.</span>
<span class="sd">    evalues : array</span>
<span class="sd">        Eigenvalues array.</span>
<span class="sd">    evectors : array</span>
<span class="sd">        Eigenvectors array.</span>
<span class="sd">    wn : array</span>
<span class="sd">        Undamped natural frequencies array.</span>
<span class="sd">    wd : array</span>
<span class="sd">        Damped natural frequencies array.</span>
<span class="sd">    log_dec : array</span>
<span class="sd">        Logarithmic decrement for each mode.</span>
<span class="sd">    damping_ratio : array</span>
<span class="sd">        Damping ratio for each mode.</span>
<span class="sd">    ndof : int</span>
<span class="sd">        Number of degrees of freedom.</span>
<span class="sd">    nodes : list</span>
<span class="sd">        List of nodes number.</span>
<span class="sd">    nodes_pos : list</span>
<span class="sd">        List of nodes positions.</span>
<span class="sd">    shaft_elements_length : list</span>
<span class="sd">        List with Rotor shaft elements lengths.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ModalResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">speed</span><span class="p">,</span>
        <span class="n">evalues</span><span class="p">,</span>
        <span class="n">evectors</span><span class="p">,</span>
        <span class="n">wn</span><span class="p">,</span>
        <span class="n">wd</span><span class="p">,</span>
        <span class="n">damping_ratio</span><span class="p">,</span>
        <span class="n">log_dec</span><span class="p">,</span>
        <span class="n">ndof</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">,</span>
        <span class="n">nodes_pos</span><span class="p">,</span>
        <span class="n">shaft_elements_length</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed</span> <span class="o">=</span> <span class="n">speed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evalues</span> <span class="o">=</span> <span class="n">evalues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evectors</span> <span class="o">=</span> <span class="n">evectors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wn</span> <span class="o">=</span> <span class="n">wn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wd</span> <span class="o">=</span> <span class="n">wd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">damping_ratio</span> <span class="o">=</span> <span class="n">damping_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span> <span class="o">=</span> <span class="n">log_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndof</span> <span class="o">=</span> <span class="n">ndof</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">nodes_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaft_elements_length</span> <span class="o">=</span> <span class="n">shaft_elements_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evectors</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndof</span><span class="p">]</span>
        <span class="n">kappa_modes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wn</span><span class="p">)):</span>
            <span class="n">kappa_color</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">kappa_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa_mode</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">kappa</span> <span class="ow">in</span> <span class="n">kappa_mode</span><span class="p">:</span>
                <span class="n">kappa_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;blue&quot;</span> <span class="k">if</span> <span class="n">kappa</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;red&quot;</span><span class="p">)</span>
            <span class="n">kappa_modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kappa_color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa_modes</span> <span class="o">=</span> <span class="n">kappa_modes</span></div>

<div class="viewcode-block" id="ModalResults.whirl"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.whirl">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">whirl</span><span class="p">(</span><span class="n">kappa_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluate the whirl of a mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kappa_mode : list</span>
<span class="sd">            A list with the value of kappa for each node related</span>
<span class="sd">            to the mode/natural frequency of interest.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        whirldir : str</span>
<span class="sd">            A string indicating the direction of precession related to the</span>
<span class="sd">            kappa_mode.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; kappa_mode = [-5.06e-13, -3.09e-13, -2.91e-13, 0.011, -4.03e-13, -2.72e-13, -2.72e-13]</span>
<span class="sd">        &gt;&gt;&gt; ModalResults.whirl(kappa_mode)</span>
<span class="sd">        &#39;Forward&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">kappa</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mf">1e-3</span> <span class="k">for</span> <span class="n">kappa</span> <span class="ow">in</span> <span class="n">kappa_mode</span><span class="p">):</span>
            <span class="n">whirldir</span> <span class="o">=</span> <span class="s2">&quot;Forward&quot;</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">kappa</span> <span class="o">&lt;=</span> <span class="mf">1e-3</span> <span class="k">for</span> <span class="n">kappa</span> <span class="ow">in</span> <span class="n">kappa_mode</span><span class="p">):</span>
            <span class="n">whirldir</span> <span class="o">=</span> <span class="s2">&quot;Backward&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">whirldir</span> <span class="o">=</span> <span class="s2">&quot;Mixed&quot;</span>
        <span class="k">return</span> <span class="n">whirldir</span></div>

    <span class="nd">@staticmethod</span>
    <span class="nd">@np</span><span class="o">.</span><span class="n">vectorize</span>
    <span class="k">def</span> <span class="nf">whirl_to_cmap</span><span class="p">(</span><span class="n">whirl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Map the whirl to a value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        whirl: string</span>
<span class="sd">            A string indicating the whirl direction related to the kappa_mode</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        An array with reference index for the whirl direction</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; whirl = &#39;Backward&#39;</span>
<span class="sd">        &gt;&gt;&gt; whirl_to_cmap(whirl)</span>
<span class="sd">        array(1.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">whirl</span> <span class="o">==</span> <span class="s2">&quot;Forward&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="n">whirl</span> <span class="o">==</span> <span class="s2">&quot;Backward&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">whirl</span> <span class="o">==</span> <span class="s2">&quot;Mixed&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.5</span>

<div class="viewcode-block" id="ModalResults.H_kappa"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.H_kappa">[docs]</a>    <span class="k">def</span> <span class="nf">H_kappa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">return_T</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the H matrix for a given node and natural frequency.</span>

<span class="sd">        The matrix H contains information about the whirl direction,</span>
<span class="sd">        the orbit minor and major axis and the orbit inclination.</span>
<span class="sd">        The matrix is calculated by :math:`H = T.T^T` where the</span>
<span class="sd">        matrix T is constructed using the eigenvector corresponding</span>
<span class="sd">        to the natural frequency of interest:</span>

<span class="sd">        .. math::</span>
<span class="sd">           :nowrap:</span>

<span class="sd">           \begin{eqnarray}</span>
<span class="sd">              \begin{bmatrix}</span>
<span class="sd">              u(t)\\</span>
<span class="sd">              v(t)</span>
<span class="sd">              \end{bmatrix}</span>
<span class="sd">              = \mathfrak{R}\Bigg(</span>
<span class="sd">              \begin{bmatrix}</span>
<span class="sd">              r_u e^{j\eta_u}\\</span>
<span class="sd">              r_v e^{j\eta_v}</span>
<span class="sd">              \end{bmatrix}\Bigg)</span>
<span class="sd">              e^{j\omega_i t}</span>
<span class="sd">              =</span>
<span class="sd">              \begin{bmatrix}</span>
<span class="sd">              r_u cos(\eta_u + \omega_i t)\\</span>
<span class="sd">              r_v cos(\eta_v + \omega_i t)</span>
<span class="sd">              \end{bmatrix}</span>
<span class="sd">              = {\bf T}</span>
<span class="sd">              \begin{bmatrix}</span>
<span class="sd">              cos(\omega_i t)\\</span>
<span class="sd">              sin(\omega_i t)</span>
<span class="sd">              \end{bmatrix}</span>
<span class="sd">           \end{eqnarray}</span>

<span class="sd">        Where :math:`r_u e^{j\eta_u}` e :math:`r_v e^{j\eta_v}` are the</span>
<span class="sd">        elements of the *i*\th eigenvector, corresponding to the node and</span>
<span class="sd">        natural frequency of interest (mode).</span>

<span class="sd">        .. math::</span>

<span class="sd">            {\bf T} =</span>
<span class="sd">            \begin{bmatrix}</span>
<span class="sd">            r_u cos(\eta_u) &amp; -r_u sin(\eta_u)\\</span>
<span class="sd">            r_u cos(\eta_u) &amp; -r_v sin(\eta_v)</span>
<span class="sd">            \end{bmatrix}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        node: int</span>
<span class="sd">            Node for which the matrix H will be calculated.</span>
<span class="sd">        w: int</span>
<span class="sd">            Index corresponding to the natural frequency</span>
<span class="sd">            of interest.</span>
<span class="sd">        return_T: bool, optional</span>
<span class="sd">            If True, returns the H matrix and a dictionary with the</span>
<span class="sd">            values for :math:`r_u, r_v, \eta_u, \eta_v`.</span>

<span class="sd">            Default is false.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        H: array</span>
<span class="sd">            Matrix H.</span>
<span class="sd">        Tdic: dict</span>
<span class="sd">            Dictionary with values for :math:`r_u, r_v, \eta_u, \eta_v`.</span>

<span class="sd">            It will be returned only if return_T is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get vector of interest based on freqs</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evectors</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">node</span> <span class="p">:</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">node</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="p">]</span>
        <span class="c1"># get translation sdofs for specified node for each mode</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ru</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">nv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="c1"># fmt: off</span>
        <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ru</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">nu</span><span class="p">),</span> <span class="o">-</span><span class="n">ru</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">nu</span><span class="p">)],</span>
                      <span class="p">[</span><span class="n">rv</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">nv</span><span class="p">),</span> <span class="o">-</span><span class="n">rv</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">nv</span><span class="p">)]])</span>
        <span class="c1"># fmt: on</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">T</span> <span class="o">@</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span>

        <span class="k">if</span> <span class="n">return_T</span><span class="p">:</span>
            <span class="n">Tdic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ru&quot;</span><span class="p">:</span> <span class="n">ru</span><span class="p">,</span> <span class="s2">&quot;rv&quot;</span><span class="p">:</span> <span class="n">rv</span><span class="p">,</span> <span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="n">nu</span><span class="p">,</span> <span class="s2">&quot;nv&quot;</span><span class="p">:</span> <span class="n">nv</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">H</span><span class="p">,</span> <span class="n">Tdic</span>

        <span class="k">return</span> <span class="n">H</span></div>

<div class="viewcode-block" id="ModalResults.kappa"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.kappa">[docs]</a>    <span class="k">def</span> <span class="nf">kappa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate kappa for a given node and natural frequency.</span>

<span class="sd">        frequency is the the index of the natural frequency of interest.</span>
<span class="sd">        The function calculates the orbit parameter :math:`\kappa`:</span>

<span class="sd">        .. math::</span>

<span class="sd">            \kappa = \pm \sqrt{\lambda_2 / \lambda_1}</span>

<span class="sd">        Where :math:`\sqrt{\lambda_1}` is the length of the semiminor axes</span>
<span class="sd">        and :math:`\sqrt{\lambda_2}` is the length of the semimajor axes.</span>

<span class="sd">        If :math:`\kappa = \pm 1`, the orbit is circular.</span>

<span class="sd">        If :math:`\kappa` is positive we have a forward rotating orbit</span>
<span class="sd">        and if it is negative we have a backward rotating orbit.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        node: int</span>
<span class="sd">            Node for which kappa will be calculated.</span>
<span class="sd">        w: int</span>
<span class="sd">            Index corresponding to the natural frequency</span>
<span class="sd">            of interest.</span>
<span class="sd">        wd: bool</span>
<span class="sd">            If True, damping natural frequencies are used.</span>

<span class="sd">            Default is true.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        kappa: dict</span>
<span class="sd">            A dictionary with values for the natural frequency,</span>
<span class="sd">            major axis, minor axis and kappa.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wd</span><span class="p">:</span>
            <span class="n">nat_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nat_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wn</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="n">H</span><span class="p">,</span> <span class="n">Tvals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">H_kappa</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">return_T</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">Tvals</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]</span>
        <span class="n">nv</span> <span class="o">=</span> <span class="n">Tvals</span><span class="p">[</span><span class="s2">&quot;nv&quot;</span><span class="p">]</span>

        <span class="n">lam</span> <span class="o">=</span> <span class="n">la</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># lam is the eigenvalue -&gt; sqrt(lam) is the minor/major axis.</span>
        <span class="c1"># kappa encodes the relation between the axis and the precession.</span>
        <span class="n">minor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="n">major</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lam</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">kappa</span> <span class="o">=</span> <span class="n">minor</span> <span class="o">/</span> <span class="n">major</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">nv</span> <span class="o">-</span> <span class="n">nu</span>

        <span class="c1"># we need to evaluate if 0 &lt; nv - nu &lt; pi.</span>
        <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">diff</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">elif</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">diff</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

        <span class="c1"># if nv = nu or nv = nu + pi then the response is a straight line.</span>
        <span class="k">if</span> <span class="n">diff</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">diff</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">kappa</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># if 0 &lt; nv - nu &lt; pi, then a backward rotating mode exists.</span>
        <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">kappa</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="n">k</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Frequency&quot;</span><span class="p">:</span> <span class="n">nat_freq</span><span class="p">,</span>
            <span class="s2">&quot;Minor axes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">minor</span><span class="p">),</span>
            <span class="s2">&quot;Major axes&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">major</span><span class="p">),</span>
            <span class="s2">&quot;kappa&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">kappa</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">k</span></div>

<div class="viewcode-block" id="ModalResults.kappa_mode"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.kappa_mode">[docs]</a>    <span class="k">def</span> <span class="nf">kappa_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Evaluate kappa values.</span>

<span class="sd">        This function evaluates kappa given the index of the natural frequency</span>
<span class="sd">        of interest.</span>
<span class="sd">        Values of kappa are evaluated for each node of the</span>
<span class="sd">        corresponding frequency mode.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        w: int</span>
<span class="sd">            Index corresponding to the natural frequency</span>
<span class="sd">            of interest.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        kappa_mode: list</span>
<span class="sd">            A list with the value of kappa for each node related</span>
<span class="sd">            to the mode/natural frequency of interest.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kappa_mode</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">w</span><span class="p">)[</span><span class="s2">&quot;kappa&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">kappa_mode</span></div>

<div class="viewcode-block" id="ModalResults.whirl_direction"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.whirl_direction">[docs]</a>    <span class="k">def</span> <span class="nf">whirl_direction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the whirl direction for each frequency.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        whirl_w : array</span>
<span class="sd">            An array of strings indicating the direction of precession related</span>
<span class="sd">            to the kappa_mode. Backward, Mixed or Forward depending on values</span>
<span class="sd">            of kappa_mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># whirl direction/values are methods because they are expensive.</span>
        <span class="n">whirl_w</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">whirl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa_mode</span><span class="p">(</span><span class="n">wd</span><span class="p">))</span> <span class="k">for</span> <span class="n">wd</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">))]</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">whirl_w</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModalResults.whirl_values"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.whirl_values">[docs]</a>    <span class="k">def</span> <span class="nf">whirl_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the whirl value (0., 0.5, or 1.) for each frequency.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        whirl_to_cmap</span>
<span class="sd">            0.0 - if the whirl is Forward</span>
<span class="sd">            0.5 - if the whirl is Mixed</span>
<span class="sd">            1.0 - if the whirl is Backward</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">whirl_to_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">whirl_direction</span><span class="p">())</span></div>

<div class="viewcode-block" id="ModalResults.calc_mode_shape"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.calc_mode_shape">[docs]</a>    <span class="k">def</span> <span class="nf">calc_mode_shape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">evec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the arrays describing the mode shapes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            The n&#39;th vibration mode</span>
<span class="sd">            Default is None</span>
<span class="sd">        evec : array</span>
<span class="sd">            Array containing the system eigenvectors</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xn : array</span>
<span class="sd">            absolut nodal displacement - X direction</span>
<span class="sd">        yn : array</span>
<span class="sd">            absolut nodal displacement - Y direction</span>
<span class="sd">        zn : array</span>
<span class="sd">            absolut nodal displacement - Z direction</span>
<span class="sd">        x_circles : array</span>
<span class="sd">            orbit description - X direction</span>
<span class="sd">        y_circles : array</span>
<span class="sd">            orbit description - Y direction</span>
<span class="sd">        z_circles_pos : array</span>
<span class="sd">            axial location of each orbit</span>
<span class="sd">        nn : int</span>
<span class="sd">            number of points to plot lines</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">evec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">evec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes</span><span class="p">[:,</span> <span class="n">mode</span><span class="p">]</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span>
        <span class="n">shaft_elements_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shaft_elements_length</span>

        <span class="n">modex</span> <span class="o">=</span> <span class="n">evec</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">modey</span> <span class="o">=</span> <span class="n">evec</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">xmax</span><span class="p">,</span> <span class="n">ixmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">modex</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">modex</span><span class="p">))</span>
        <span class="n">ymax</span><span class="p">,</span> <span class="n">iymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">modey</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">modey</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ymax</span> <span class="o">&gt;</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">xmax</span><span class="p">:</span>
            <span class="n">evec</span> <span class="o">/=</span> <span class="n">modey</span><span class="p">[</span><span class="n">iymax</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evec</span> <span class="o">/=</span> <span class="n">modex</span><span class="p">[</span><span class="n">ixmax</span><span class="p">]</span>

        <span class="n">modex</span> <span class="o">=</span> <span class="n">evec</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">modey</span> <span class="o">=</span> <span class="n">evec</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span>

        <span class="n">num_points</span> <span class="o">=</span> <span class="mi">201</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">num_points</span><span class="p">)</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

        <span class="n">x_circles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span>
        <span class="n">y_circles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span>
        <span class="n">z_circles_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_points</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">modex</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">*</span> <span class="n">circle</span>
            <span class="n">x_circles</span><span class="p">[:,</span> <span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">modey</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">*</span> <span class="n">circle</span>
            <span class="n">y_circles</span><span class="p">[:,</span> <span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">z_circles_pos</span><span class="p">[:,</span> <span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes_pos</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>

        <span class="c1"># plot lines</span>
        <span class="n">nn</span> <span class="o">=</span> <span class="mi">21</span>
        <span class="n">zeta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nn</span><span class="p">)</span>
        <span class="n">onn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>

        <span class="n">zeta</span> <span class="o">=</span> <span class="n">zeta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">onn</span> <span class="o">=</span> <span class="n">onn</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">xn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nn</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">yn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nn</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">zn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nn</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">N1</span> <span class="o">=</span> <span class="n">onn</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">N3</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">3</span>
        <span class="n">N4</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">zeta</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">zeta</span> <span class="o">**</span> <span class="mi">3</span>

        <span class="k">for</span> <span class="n">Le</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">shaft_elements_length</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
            <span class="n">node_pos</span> <span class="o">=</span> <span class="n">nodes_pos</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">Nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">N1</span><span class="p">,</span> <span class="n">Le</span> <span class="o">*</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="n">Le</span> <span class="o">*</span> <span class="n">N4</span><span class="p">))</span>
            <span class="n">Ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">N1</span><span class="p">,</span> <span class="o">-</span><span class="n">Le</span> <span class="o">*</span> <span class="n">N2</span><span class="p">,</span> <span class="n">N3</span><span class="p">,</span> <span class="o">-</span><span class="n">Le</span> <span class="o">*</span> <span class="n">N4</span><span class="p">))</span>

            <span class="n">xx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">n</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span>
            <span class="n">yy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>

            <span class="n">pos0</span> <span class="o">=</span> <span class="n">nn</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">pos1</span> <span class="o">=</span> <span class="n">nn</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">xn</span><span class="p">[</span><span class="n">pos0</span><span class="p">:</span><span class="n">pos1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nx</span> <span class="o">@</span> <span class="n">evec</span><span class="p">[</span><span class="n">xx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
            <span class="n">yn</span><span class="p">[</span><span class="n">pos0</span><span class="p">:</span><span class="n">pos1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ny</span> <span class="o">@</span> <span class="n">evec</span><span class="p">[</span><span class="n">yy</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
            <span class="n">zn</span><span class="p">[</span><span class="n">pos0</span><span class="p">:</span><span class="n">pos1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">node_pos</span> <span class="o">*</span> <span class="n">onn</span> <span class="o">+</span> <span class="n">Le</span> <span class="o">*</span> <span class="n">zeta</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">zn</span><span class="p">,</span> <span class="n">x_circles</span><span class="p">,</span> <span class="n">y_circles</span><span class="p">,</span> <span class="n">z_circles_pos</span><span class="p">,</span> <span class="n">nn</span></div>

<div class="viewcode-block" id="ModalResults.plot_mode_3d"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.plot_mode_3d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mode_3d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">evec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">frequency_type</span><span class="o">=</span><span class="s2">&quot;wd&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot (3D view) the mode shapes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            The n&#39;th vibration mode</span>
<span class="sd">            Default is None</span>
<span class="sd">        evec : array</span>
<span class="sd">            Array containing the system eigenvectors</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        frequency_type : str, optional</span>
<span class="sd">            &quot;wd&quot; calculates de map for the damped natural frequencies.</span>
<span class="sd">            &quot;wn&quot; calculates de map for the undamped natural frequencies.</span>
<span class="sd">            Defaults is &quot;wd&quot;.</span>
<span class="sd">        title : str, optional</span>
<span class="sd">            A brief title to the mode shape plot, it will be displayed above other</span>
<span class="sd">            relevant data in the plot area. It does not modify the figure layout from</span>
<span class="sd">            Plotly.</span>
<span class="sd">        length_units : str, optional</span>
<span class="sd">            length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units that will be used in the plot title.</span>
<span class="sd">            Default is rad/s.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">kappa_mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa_modes</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
        <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">zn</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc_pos</span><span class="p">,</span> <span class="n">nn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_mode_shape</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">evec</span><span class="o">=</span><span class="n">evec</span><span class="p">)</span>

        <span class="c1"># fmt: off</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;wd&quot;</span><span class="p">:</span>  <span class="sa">f</span><span class="s2">&quot;ω&lt;sub&gt;d&lt;/sub&gt; = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">[</span><span class="n">mode</span><span class="p">],</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;wn&quot;</span><span class="p">:</span>  <span class="sa">f</span><span class="s2">&quot;ω&lt;sub&gt;n&lt;/sub&gt; = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wn</span><span class="p">[</span><span class="n">mode</span><span class="p">],</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Speed = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># fmt: on</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">zc_pos</span><span class="p">[</span><span class="mi">10</span><span class="p">:,</span> <span class="n">node</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">xc</span><span class="p">[</span><span class="mi">10</span><span class="p">:,</span> <span class="n">node</span><span class="p">],</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">yc</span><span class="p">[</span><span class="mi">10</span><span class="p">:,</span> <span class="n">node</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">kappa_mode</span><span class="p">[</span><span class="n">node</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Nodal Position: %</span><span class="si">{x:.2f}</span><span class="s2">&lt;br&gt;&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;X - Relative Displacement: %</span><span class="si">{y:.2f}</span><span class="s2">&lt;br&gt;&quot;</span>
                        <span class="o">+</span> <span class="s2">&quot;Y - Relative Displacement: %</span><span class="si">{z:.2f}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">([</span><span class="n">zc_pos</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="n">node</span><span class="p">]],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">xc</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="n">node</span><span class="p">]],</span>
                    <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">yc</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="n">node</span><span class="p">]],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">kappa_mode</span><span class="p">[</span><span class="n">node</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;node </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">),</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">xn</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">yn</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mode shape&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># plot center line</span>
        <span class="n">zn_cl0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">zn_cl1</span> <span class="o">=</span> <span class="n">zn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.1</span>
        <span class="n">zn_cl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">zn_cl0</span><span class="p">,</span> <span class="n">zn_cl1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">zn_cl</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">zn_cl</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">zn_cl</span> <span class="o">*</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">),</span>
                    <span class="n">autorange</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span>
                    <span class="n">nticks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Relative Displacement&quot;</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">nticks</span><span class="o">=</span><span class="mi">5</span>
                <span class="p">),</span>
                <span class="n">zaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Relative Displacement&quot;</span><span class="p">),</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">nticks</span><span class="o">=</span><span class="mi">5</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Mode </span><span class="si">{</span><span class="n">mode</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;whirl: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">whirl_direction</span><span class="p">()[</span><span class="n">mode</span><span class="p">]</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">frequency</span><span class="p">[</span><span class="n">frequency_type</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Log. Dec. = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Damping ratio = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">damping_ratio</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ModalResults.plot_mode_2d"><a class="viewcode-back" href="../../generated/results/ross.ModalResults.html#ross.ModalResults.plot_mode_2d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mode_2d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">evec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">frequency_type</span><span class="o">=</span><span class="s2">&quot;wd&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot (2D view) the mode shapes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode : int</span>
<span class="sd">            The n&#39;th vibration mode</span>
<span class="sd">            Default is None</span>
<span class="sd">        evec : array</span>
<span class="sd">            Array containing the system eigenvectors</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        frequency_type : str, optional</span>
<span class="sd">            &quot;wd&quot; calculates de map for the damped natural frequencies.</span>
<span class="sd">            &quot;wn&quot; calculates de map for the undamped natural frequencies.</span>
<span class="sd">            Defaults is &quot;wd&quot;.</span>
<span class="sd">        title : str, optional</span>
<span class="sd">            A brief title to the mode shape plot, it will be displayed above other</span>
<span class="sd">            relevant data in the plot area. It does not modify the figure layout from</span>
<span class="sd">            Plotly.</span>
<span class="sd">        length_units : str, optional</span>
<span class="sd">            length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units that will be used in the plot title.</span>
<span class="sd">            Default is rad/s.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">zn</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span><span class="p">,</span> <span class="n">zc_pos</span><span class="p">,</span> <span class="n">nn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_mode_shape</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">evec</span><span class="o">=</span><span class="n">evec</span><span class="p">)</span>
        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">xn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">yn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="n">xn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">+</span> <span class="n">yn</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="c1"># remove repetitive values from zn and vn</span>
        <span class="n">idx_remove</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">zn</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">zn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">zn</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]:</span>
                <span class="n">idx_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">zn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span> <span class="n">idx_remove</span><span class="p">)</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">vn</span><span class="p">,</span> <span class="n">idx_remove</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">colors</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Backward</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">Mixed</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">Forward</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

        <span class="c1"># fmt: off</span>
        <span class="n">frequency</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;wd&quot;</span><span class="p">:</span>  <span class="sa">f</span><span class="s2">&quot;ω&lt;sub&gt;d&lt;/sub&gt; = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">[</span><span class="n">mode</span><span class="p">],</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;wn&quot;</span><span class="p">:</span>  <span class="sa">f</span><span class="s2">&quot;ω&lt;sub&gt;n&lt;/sub&gt; = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wn</span><span class="p">[</span><span class="n">mode</span><span class="p">],</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Speed = </span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">,</span> <span class="s1">&#39;rad/s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># fmt: on</span>
        <span class="n">whirl_dir</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">whirl_direction</span><span class="p">()[</span><span class="n">mode</span><span class="p">]]</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">vn</span> <span class="o">/</span> <span class="n">vn</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vn</span><span class="p">))],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">whirl_dir</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mode shape&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># plot center line</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">)),</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;centerline&quot;</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Relative Displacement&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;br&gt;&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Mode </span><span class="si">{</span><span class="n">mode</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">frequency</span><span class="p">[</span><span class="s1">&#39;speed&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;whirl: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">whirl_direction</span><span class="p">()[</span><span class="n">mode</span><span class="p">]</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">frequency</span><span class="p">[</span><span class="n">frequency_type</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Log. Dec. = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> | &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Damping ratio = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">damping_ratio</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="CampbellResults"><a class="viewcode-back" href="../../generated/results/ross.CampbellResults.html#ross.CampbellResults">[docs]</a><span class="k">class</span> <span class="nc">CampbellResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Campbell Diagram.</span>

<span class="sd">    It&#39;s possible to visualize multiples harmonics in a single plot to check</span>
<span class="sd">    other speeds which also excite a specific natural frequency.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    speed_range : array</span>
<span class="sd">        Array with the speed range in rad/s.</span>
<span class="sd">    wd : array</span>
<span class="sd">        Array with the damped natural frequencies</span>
<span class="sd">    log_dec : array</span>
<span class="sd">        Array with the Logarithmic decrement</span>
<span class="sd">    whirl_values : array</span>
<span class="sd">        Array with the whirl values (0, 0.5 or 1)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Plotly graph_objects.Figure()</span>
<span class="sd">        The figure object with the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CampbellResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.CampbellResults.html#ross.CampbellResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed_range</span><span class="p">,</span> <span class="n">wd</span><span class="p">,</span> <span class="n">log_dec</span><span class="p">,</span> <span class="n">whirl_values</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span> <span class="o">=</span> <span class="n">speed_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wd</span> <span class="o">=</span> <span class="n">wd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span> <span class="o">=</span> <span class="n">log_dec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">whirl_values</span> <span class="o">=</span> <span class="n">whirl_values</span></div>

<div class="viewcode-block" id="CampbellResults.plot"><a class="viewcode-back" href="../../generated/results/ross.CampbellResults.html#ross.CampbellResults.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">harmonics</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create Campbell Diagram figure using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        harmonics: list, optional</span>
<span class="sd">            List withe the harmonics to be plotted.</span>
<span class="sd">            The default is to plot 1x.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wd</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wd</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">num_frequencies</span> <span class="o">=</span> <span class="n">wd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">log_dec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span>
        <span class="n">whirl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">whirl_values</span>
        <span class="n">speed_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">default_values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">coloraxis_cmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="n">coloraxis_cmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
            <span class="n">coloraxis_colorscale</span><span class="o">=</span><span class="s2">&quot;rdbu&quot;</span><span class="p">,</span>
            <span class="n">coloraxis_colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;&lt;b&gt;Log Dec&lt;/b&gt;&quot;</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">default_values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">crit_x</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crit_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_frequencies</span><span class="p">):</span>
            <span class="n">w_i</span> <span class="o">=</span> <span class="n">wd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">harm</span> <span class="ow">in</span> <span class="n">harmonics</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">speed_range</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="n">w_i</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">speed_range</span>
                <span class="n">y2</span> <span class="o">=</span> <span class="n">harm</span> <span class="o">*</span> <span class="n">speed_range</span>

                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
                <span class="n">crit_x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">crit_y</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">crit_x</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">crit_y</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">crit_x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">crit_y</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Crit. Speed&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Crit. Speed&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Critical Speed (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2f</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">scatter_marker</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;triangle-up&quot;</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="s2">&quot;triangle-down&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mark</span><span class="p">,</span> <span class="n">whirl_dir</span><span class="p">,</span> <span class="n">legend</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">scatter_marker</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Foward&quot;</span><span class="p">,</span> <span class="s2">&quot;Mixed&quot;</span><span class="p">,</span> <span class="s2">&quot;Backward&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_frequencies</span><span class="p">):</span>
                <span class="n">w_i</span> <span class="o">=</span> <span class="n">wd</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
                <span class="n">whirl_i</span> <span class="o">=</span> <span class="n">whirl</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
                <span class="n">log_dec_i</span> <span class="o">=</span> <span class="n">log_dec</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

                <span class="n">whirl_mask</span> <span class="o">=</span> <span class="n">whirl_i</span> <span class="o">==</span> <span class="n">whirl_dir</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">check</span> <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="n">whirl_mask</span><span class="p">):</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                            <span class="n">x</span><span class="o">=</span><span class="n">speed_range</span><span class="p">[</span><span class="n">whirl_mask</span><span class="p">],</span>
                            <span class="n">y</span><span class="o">=</span><span class="n">w_i</span><span class="p">[</span><span class="n">whirl_mask</span><span class="p">],</span>
                            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                                <span class="n">symbol</span><span class="o">=</span><span class="n">mark</span><span class="p">,</span>
                                <span class="n">color</span><span class="o">=</span><span class="n">log_dec_i</span><span class="p">[</span><span class="n">whirl_mask</span><span class="p">],</span>
                                <span class="n">coloraxis</span><span class="o">=</span><span class="s2">&quot;coloraxis&quot;</span><span class="p">,</span>
                            <span class="p">),</span>
                            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                            <span class="n">legendgroup</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">harmonics</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">speed_range</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">h</span> <span class="o">*</span> <span class="n">speed_range</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">j</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">x speed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="c1"># turn legend glyphs black</span>
        <span class="n">scatter_marker</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;triangle-up&quot;</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span> <span class="s2">&quot;triangle-down&quot;</span><span class="p">]</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Foward&quot;</span><span class="p">,</span> <span class="s2">&quot;Mixed&quot;</span><span class="p">,</span> <span class="s2">&quot;Backward&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mark</span><span class="p">,</span> <span class="n">legend</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scatter_marker</span><span class="p">,</span> <span class="n">legends</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">mark</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">speed_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">speed_range</span><span class="p">)],</span>
            <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Natural Frequencies (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">wd</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">itemsizing</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="FrequencyResponseResults"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults">[docs]</a><span class="k">class</span> <span class="nc">FrequencyResponseResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Frequency Response.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    freq_resp : array</span>
<span class="sd">        Array with the frequency response (displacement).</span>
<span class="sd">    velc_resp : array</span>
<span class="sd">        Array with the frequency response (velocity).</span>
<span class="sd">    accl_resp : array</span>
<span class="sd">        Array with the frequency response (acceleration).</span>
<span class="sd">    speed_range : array</span>
<span class="sd">        Array with the speed range in rad/s.</span>
<span class="sd">    number_dof : int</span>
<span class="sd">        Number of degrees of freedom per node.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">        Plotly figure with Amplitude vs Frequency and Phase vs Frequency plots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FrequencyResponseResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq_resp</span><span class="p">,</span> <span class="n">velc_resp</span><span class="p">,</span> <span class="n">accl_resp</span><span class="p">,</span> <span class="n">speed_range</span><span class="p">,</span> <span class="n">number_dof</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freq_resp</span> <span class="o">=</span> <span class="n">freq_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span> <span class="o">=</span> <span class="n">velc_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span> <span class="o">=</span> <span class="n">accl_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span> <span class="o">=</span> <span class="n">speed_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span> <span class="o">=</span> <span class="n">number_dof</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;α&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">:</span> <span class="s2">&quot;β&quot;</span><span class="p">}</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">:</span> <span class="s2">&quot;α&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">:</span> <span class="s2">&quot;β&quot;</span><span class="p">,</span> <span class="s2">&quot;6&quot;</span><span class="p">:</span> <span class="s2">&quot;θ&quot;</span><span class="p">}</span></div>

<div class="viewcode-block" id="FrequencyResponseResults.plot_magnitude"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults.plot_magnitude">[docs]</a>    <span class="k">def</span> <span class="nf">plot_magnitude</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inp</span><span class="p">,</span>
        <span class="n">out</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m/N&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">mag_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot frequency response (magnitude) using Plotly.</span>

<span class="sd">        This method plots the frequency response magnitude given an output and</span>
<span class="sd">        an input using Plotly.</span>
<span class="sd">        It is possible to plot displacement, velocity and accelaration responses,</span>
<span class="sd">        depending on the unit entered in &#39;amplitude_units&#39;. If &#39;[length]/[force]&#39;,</span>
<span class="sd">        it displays the displacement; If &#39;[speed]/[force]&#39;, it displays the velocity;</span>
<span class="sd">        If &#39;[acceleration]/[force]&#39;, it displays the acceleration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inp : int</span>
<span class="sd">            Input.</span>
<span class="sd">        out : int</span>
<span class="sd">            Output.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units are:</span>
<span class="sd">                &#39;[length]/[force]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]/[force]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]/[force]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m/N&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m/N)</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        mag_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inpn</span> <span class="o">=</span> <span class="n">inp</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">idof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">inp</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>
        <span class="n">outn</span> <span class="o">=</span> <span class="n">out</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">odof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>

        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">dummy_var</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[length]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_resp</span><span class="p">)</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Displacement&quot;</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[speed]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span><span class="p">)</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/s/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Velocity&quot;</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[acceleration]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span><span class="p">)</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/s**2/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Acceleration&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Options are &#39;[length]/[force]&#39;, &#39;[speed]/[force]&#39;, &#39;[acceleration]/[force]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">mag</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">idx</span><span class="p">]),</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">mag_kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="FrequencyResponseResults.plot_phase"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults.plot_phase">[docs]</a>    <span class="k">def</span> <span class="nf">plot_phase</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inp</span><span class="p">,</span>
        <span class="n">out</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m/N&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">phase_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot frequency response (phase) using Plotly.</span>

<span class="sd">        This method plots the frequency response phase given an output and</span>
<span class="sd">        an input using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inp : int</span>
<span class="sd">            Input.</span>
<span class="sd">        out : int</span>
<span class="sd">            Output.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units are:</span>
<span class="sd">                &#39;[length]/[force]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]/[force]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]/[force]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m/N&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m/N)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        phase_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inpn</span> <span class="o">=</span> <span class="n">inp</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">idof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">inp</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>
        <span class="n">outn</span> <span class="o">=</span> <span class="n">out</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">odof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>

        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">dummy_var</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[length]/[force]&quot;</span><span class="p">):</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[speed]/[force]&quot;</span><span class="p">):</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[acceleration]/[force]&quot;</span><span class="p">):</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Options are &#39;[length]/[force]&#39;, &#39;[speed]/[force]&#39;, &#39;[acceleration]/[force]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="n">phase</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">phase_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">phase_units</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="s2">&quot;radian&quot;</span><span class="p">,</span> <span class="s2">&quot;radians&quot;</span><span class="p">]:</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">phase</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">360</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">phase</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">idx</span><span class="p">]),</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Phase: %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Phase (</span><span class="si">{</span><span class="n">phase_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">phase_kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="FrequencyResponseResults.plot_polar_bode"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults.plot_polar_bode">[docs]</a>    <span class="k">def</span> <span class="nf">plot_polar_bode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inp</span><span class="p">,</span>
        <span class="n">out</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m/N&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">polar_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot frequency response (polar) using Plotly.</span>

<span class="sd">        This method plots the frequency response (polar graph) given an output and</span>
<span class="sd">        an input using Plotly.</span>
<span class="sd">        It is possible to plot displacement, velocity and accelaration responses,</span>
<span class="sd">        depending on the unit entered in &#39;amplitude_units&#39;. If &#39;[length]/[force]&#39;,</span>
<span class="sd">        it displays the displacement; If &#39;[speed]/[force]&#39;, it displays the velocity;</span>
<span class="sd">        If &#39;[acceleration]/[force]&#39;, it displays the acceleration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inp : int</span>
<span class="sd">            Input.</span>
<span class="sd">        out : int</span>
<span class="sd">            Output.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units are:</span>
<span class="sd">                &#39;[length]/[force]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]/[force]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]/[force]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m/N&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m/N)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        polar_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inpn</span> <span class="o">=</span> <span class="n">inp</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">idof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">inp</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>
        <span class="n">outn</span> <span class="o">=</span> <span class="n">out</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">odof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_dof</span><span class="p">)]</span>

        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">dummy_var</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[length]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Displacement&quot;</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[speed]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/s/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Velocity&quot;</span>
        <span class="k">elif</span> <span class="n">dummy_var</span><span class="o">.</span><span class="n">check</span><span class="p">(</span><span class="s2">&quot;[acceleration]/[force]&quot;</span><span class="p">):</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">mag</span><span class="p">,</span> <span class="s2">&quot;m/s**2/N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span><span class="p">[</span><span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="p">:])</span>
            <span class="n">y_label</span> <span class="o">=</span> <span class="s2">&quot;Acceleration&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Options are &#39;[length]/[force]&#39;, &#39;[speed]/[force]&#39;, &#39;[acceleration]/[force]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="n">phase</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">phase_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">phase_units</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="s2">&quot;radian&quot;</span><span class="p">,</span> <span class="s2">&quot;radians&quot;</span><span class="p">]:</span>
            <span class="n">polar_theta_unit</span> <span class="o">=</span> <span class="s2">&quot;radians&quot;</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">phase</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">polar_theta_unit</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">360</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">phase</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
                <span class="n">r</span><span class="o">=</span><span class="n">mag</span><span class="p">,</span>
                <span class="n">theta</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span>
                <span class="n">customdata</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                <span class="n">thetaunit</span><span class="o">=</span><span class="n">polar_theta_unit</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">idx</span><span class="p">]),</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">idx</span><span class="p">]),</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;inp: node </span><span class="si">{</span><span class="n">inpn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">idof</span><span class="si">}</span><span class="s2">&lt;br&gt;out: node </span><span class="si">{</span><span class="n">outn</span><span class="si">}</span><span class="s2"> | dof: </span><span class="si">{</span><span class="n">odof</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">r:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Phase: %</span><span class="se">{{</span><span class="s2">theta:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">customdata:.2f</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">radialaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">y_label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">),</span>
                    <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">angularaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">thetaunit</span><span class="o">=</span><span class="n">polar_theta_unit</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">polar_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="FrequencyResponseResults.plot"><a class="viewcode-back" href="../../generated/results/ross.FrequencyResponseResults.html#ross.FrequencyResponseResults.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inp</span><span class="p">,</span>
        <span class="n">out</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m/N&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mag_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">phase_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">polar_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fig_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot frequency response.</span>

<span class="sd">        This method plots the frequency response given an output and an input</span>
<span class="sd">        using Plotly.</span>

<span class="sd">        This method returns a subplot with:</span>
<span class="sd">            - Frequency vs Amplitude;</span>
<span class="sd">            - Frequency vs Phase Angle;</span>
<span class="sd">            - Polar plot Amplitude vs Phase Angle;</span>

<span class="sd">        Amplitude can be displacement, velocity or accelaration responses,</span>
<span class="sd">        depending on the unit entered in &#39;amplitude_units&#39;. If &#39;[length]/[force]&#39;,</span>
<span class="sd">        it displays the displacement; If &#39;[speed]/[force]&#39;, it displays the velocity;</span>
<span class="sd">        If &#39;[acceleration]/[force]&#39;, it displays the acceleration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inp : int</span>
<span class="sd">            Input.</span>
<span class="sd">        out : int</span>
<span class="sd">            Output.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units are:</span>
<span class="sd">                &#39;[length]/[force]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]/[force]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]/[force]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m/N&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m/N)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        mag_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the magnitude plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        phase_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the phase plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        polar_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the polar plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        fig_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...). This kwargs override &quot;mag_kwargs&quot;,</span>
<span class="sd">            &quot;phase_kwargs&quot; and &quot;polar_kwargs&quot; dictionaries.</span>
<span class="sd">            *See Plotly Python make_subplots Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">            Plotly figure with Amplitude vs Frequency and Phase vs Frequency and</span>
<span class="sd">            polar Amplitude vs Phase plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mag_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">mag_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mag_kwargs</span><span class="p">)</span>
        <span class="n">phase_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">phase_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">phase_kwargs</span><span class="p">)</span>
        <span class="n">polar_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">polar_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">polar_kwargs</span><span class="p">)</span>
        <span class="n">fig_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">fig_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fig_kwargs</span><span class="p">)</span>

        <span class="n">fig0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_magnitude</span><span class="p">(</span>
            <span class="n">inp</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">mag_kwargs</span>
        <span class="p">)</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_phase</span><span class="p">(</span>
            <span class="n">inp</span><span class="p">,</span>
            <span class="n">out</span><span class="p">,</span>
            <span class="n">frequency_units</span><span class="p">,</span>
            <span class="n">amplitude_units</span><span class="p">,</span>
            <span class="n">phase_units</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">phase_kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_polar_bode</span><span class="p">(</span>
            <span class="n">inp</span><span class="p">,</span>
            <span class="n">out</span><span class="p">,</span>
            <span class="n">frequency_units</span><span class="p">,</span>
            <span class="n">amplitude_units</span><span class="p">,</span>
            <span class="n">phase_units</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">polar_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
                <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">specs</span><span class="o">=</span><span class="p">[[{},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="s2">&quot;rowspan&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span> <span class="p">[{},</span> <span class="kc">None</span><span class="p">]],</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig1</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig2</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig0</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig0</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">radialaxis</span><span class="o">=</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">radialaxis</span><span class="p">,</span>
                <span class="n">angularaxis</span><span class="o">=</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">angularaxis</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">fig_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="ForcedResponseResults"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults">[docs]</a><span class="k">class</span> <span class="nc">ForcedResponseResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Forced Response analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rotor : ross.Rotor object</span>
<span class="sd">        The Rotor object</span>
<span class="sd">    force_resp : array</span>
<span class="sd">        Array with the forced response (displacement) for each node for each frequency.</span>
<span class="sd">    velc_resp : array</span>
<span class="sd">        Array with the forced response (velocity) for each node for each frequency.</span>
<span class="sd">    accl_resp : array</span>
<span class="sd">        Array with the forced response (acceleration) for each node for each frequency.</span>
<span class="sd">    speed_range : array</span>
<span class="sd">        Array with the frequencies.</span>
<span class="sd">    unbalance : array, optional</span>
<span class="sd">        Array with the unbalance data (node, magnitude and phase) to be plotted</span>
<span class="sd">        with deflected shape. This argument is set only if running an unbalance</span>
<span class="sd">        response analysis.</span>
<span class="sd">        Default is None.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">        Plotly figure with Amplitude vs Frequency and Phase vs Frequency plots.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ForcedResponseResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">rotor</span><span class="p">,</span> <span class="n">forced_resp</span><span class="p">,</span> <span class="n">velc_resp</span><span class="p">,</span> <span class="n">accl_resp</span><span class="p">,</span> <span class="n">speed_range</span><span class="p">,</span> <span class="n">unbalance</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span> <span class="o">=</span> <span class="n">rotor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forced_resp</span> <span class="o">=</span> <span class="n">forced_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velc_resp</span> <span class="o">=</span> <span class="n">velc_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accl_resp</span> <span class="o">=</span> <span class="n">accl_resp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span> <span class="o">=</span> <span class="n">speed_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unbalance</span> <span class="o">=</span> <span class="n">unbalance</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;[length]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;forced_resp&quot;</span><span class="p">],</span>
            <span class="s2">&quot;[length] / [time]&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;m/s&quot;</span><span class="p">,</span> <span class="s2">&quot;velc_resp&quot;</span><span class="p">],</span>
            <span class="s2">&quot;[length] / [time] ** 2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;m/s**2&quot;</span><span class="p">,</span> <span class="s2">&quot;accl_resp&quot;</span><span class="p">],</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_magnitude"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_magnitude">[docs]</a>    <span class="k">def</span> <span class="nf">plot_magnitude</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">probe</span><span class="p">,</span>
        <span class="n">probe_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot forced response (magnitude) using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        probe : list of tuples</span>
<span class="sd">            List with tuples (node, orientation angle, tag).</span>
<span class="sd">            node : int</span>
<span class="sd">                indicate the node where the probe is located.</span>
<span class="sd">            orientation : float</span>
<span class="sd">                probe orientation angle about the shaft. The 0 refers to +X direction.</span>
<span class="sd">            tag : str, optional</span>
<span class="sd">                probe tag to be displayed at the legend.</span>
<span class="sd">        probe_units : str, option</span>
<span class="sd">            Units for probe orientation.</span>
<span class="sd">            Default is &quot;rad&quot;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probe</span><span class="p">):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">probe_units</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_major_axis_per_node</span><span class="p">(</span>
                <span class="n">node</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="o">=</span><span class="n">amplitude_units</span>
            <span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Probe </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - Node </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vector</span><span class="p">),</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_phase"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_phase">[docs]</a>    <span class="k">def</span> <span class="nf">plot_phase</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">probe</span><span class="p">,</span>
        <span class="n">probe_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot forced response (phase) using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        probe : list of tuples</span>
<span class="sd">            List with tuples (node, orientation angle, tag).</span>
<span class="sd">            node : int</span>
<span class="sd">                indicate the node where the probe is located.</span>
<span class="sd">            orientation : float</span>
<span class="sd">                probe orientation angle about the shaft. The 0 refers to +X direction.</span>
<span class="sd">            tag : str, optional</span>
<span class="sd">                probe tag to be displayed at the legend.</span>
<span class="sd">        probe_units : str, option</span>
<span class="sd">            Units for probe orientation.</span>
<span class="sd">            Default is &quot;rad&quot;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probe</span><span class="p">):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">probe_units</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_major_axis_per_node</span><span class="p">(</span>
                <span class="n">node</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="o">=</span><span class="n">amplitude_units</span>
            <span class="p">)[</span><span class="mi">4</span><span class="p">]</span>

            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">probe_phase</span><span class="p">])</span>
            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">probe_phase</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">phase_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Probe </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - Node </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">probe_phase</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Phase (</span><span class="si">{</span><span class="n">phase_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">frequency_range</span><span class="p">)],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Phase (</span><span class="si">{</span><span class="n">phase_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_polar_bode"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_polar_bode">[docs]</a>    <span class="k">def</span> <span class="nf">plot_polar_bode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">probe</span><span class="p">,</span>
        <span class="n">probe_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot polar forced response using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        probe : list of tuples</span>
<span class="sd">            List with tuples (node, orientation angle, tag).</span>
<span class="sd">            node : int</span>
<span class="sd">                indicate the node where the probe is located.</span>
<span class="sd">            orientation : float</span>
<span class="sd">                probe orientation angle about the shaft. The 0 refers to +X direction.</span>
<span class="sd">            tag : str, optional</span>
<span class="sd">                probe tag to be displayed at the legend.</span>
<span class="sd">        probe_units : str, option</span>
<span class="sd">            Units for probe orientation.</span>
<span class="sd">            Default is &quot;rad&quot;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frequency_range</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probe</span><span class="p">):</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">probe_units</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_major_axis_per_node</span><span class="p">(</span>
                <span class="n">node</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="o">=</span><span class="n">amplitude_units</span>
            <span class="p">)</span>

            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">probe_phase</span><span class="p">])</span>
            <span class="n">probe_phase</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">probe_phase</span><span class="p">,</span> <span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">phase_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

            <span class="k">if</span> <span class="n">phase_units</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span> <span class="s2">&quot;radian&quot;</span><span class="p">,</span> <span class="s2">&quot;radians&quot;</span><span class="p">]:</span>
                <span class="n">polar_theta_unit</span> <span class="o">=</span> <span class="s2">&quot;radians&quot;</span>
            <span class="k">elif</span> <span class="n">phase_units</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">,</span> <span class="s2">&quot;degrees&quot;</span><span class="p">,</span> <span class="s2">&quot;deg&quot;</span><span class="p">]:</span>
                <span class="n">polar_theta_unit</span> <span class="o">=</span> <span class="s2">&quot;degrees&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Probe </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - Node </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatterpolar</span><span class="p">(</span>
                    <span class="n">r</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vector</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">theta</span><span class="o">=</span><span class="n">probe_phase</span><span class="p">,</span>
                    <span class="n">customdata</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">,</span>
                    <span class="n">thetaunit</span><span class="o">=</span><span class="n">polar_theta_unit</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">tableau_colors</span><span class="p">)[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">r:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Phase: %</span><span class="se">{{</span><span class="s2">theta:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">customdata:.2f</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">radialaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">),</span>
                    <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">angularaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">thetaunit</span><span class="o">=</span><span class="n">polar_theta_unit</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">probe</span><span class="p">,</span>
        <span class="n">probe_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">phase_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">mag_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">phase_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">polar_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subplot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot forced response.</span>

<span class="sd">        This method returns a subplot with:</span>
<span class="sd">            - Frequency vs Amplitude;</span>
<span class="sd">            - Frequency vs Phase Angle;</span>
<span class="sd">            - Polar plot Amplitude vs Phase Angle;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        probe : list of tuples</span>
<span class="sd">            List with tuples (node, orientation angle, tag).</span>
<span class="sd">            node : int</span>
<span class="sd">                indicate the node where the probe is located.</span>
<span class="sd">            orientation : float</span>
<span class="sd">                probe orientation angle about the shaft. The 0 refers to +X direction.</span>
<span class="sd">            tag : str, optional</span>
<span class="sd">                probe tag to be displayed at the legend.</span>
<span class="sd">        probe_units : str, option</span>
<span class="sd">            Units for probe orientation.</span>
<span class="sd">            Default is &quot;rad&quot;.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        phase_units : str, optional</span>
<span class="sd">            Phase units.</span>
<span class="sd">            Default is &quot;rad&quot;</span>
<span class="sd">        mag_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the magnitude plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        phase_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the phase plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        polar_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the polar plot</span>
<span class="sd">            layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        subplot_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...). This kwargs override &quot;mag_kwargs&quot; and</span>
<span class="sd">            &quot;phase_kwargs&quot; dictionaries.</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">            Plotly figure with Amplitude vs Frequency and Phase vs Frequency and</span>
<span class="sd">            polar Amplitude vs Phase plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mag_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">mag_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mag_kwargs</span><span class="p">)</span>
        <span class="n">phase_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">phase_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">phase_kwargs</span><span class="p">)</span>
        <span class="n">polar_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">polar_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">polar_kwargs</span><span class="p">)</span>
        <span class="n">subplot_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">subplot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">subplot_kwargs</span><span class="p">)</span>

        <span class="c1"># fmt: off</span>
        <span class="n">fig0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_magnitude</span><span class="p">(</span>
            <span class="n">probe</span><span class="p">,</span> <span class="n">probe_units</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="o">**</span><span class="n">mag_kwargs</span>
        <span class="p">)</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_phase</span><span class="p">(</span>
            <span class="n">probe</span><span class="p">,</span> <span class="n">probe_units</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="n">phase_units</span><span class="p">,</span> <span class="o">**</span><span class="n">phase_kwargs</span>
        <span class="p">)</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_polar_bode</span><span class="p">(</span>
            <span class="n">probe</span><span class="p">,</span> <span class="n">probe_units</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="n">phase_units</span><span class="p">,</span> <span class="o">**</span><span class="n">polar_kwargs</span>
        <span class="p">)</span>
        <span class="c1"># fmt: on</span>

        <span class="n">subplots</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[[{},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="s2">&quot;rowspan&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span> <span class="p">[{},</span> <span class="kc">None</span><span class="p">]],</span>
            <span class="n">shared_xaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig1</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig2</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">subplots</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig0</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">polar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">radialaxis</span><span class="o">=</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">radialaxis</span><span class="p">,</span>
                <span class="n">angularaxis</span><span class="o">=</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">polar</span><span class="o">.</span><span class="n">angularaxis</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">subplot_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">subplots</span></div>

    <span class="k">def</span> <span class="nf">_calculate_major_axis_per_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the major axis for a node for each frequency.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        node : float</span>
<span class="sd">            A node from the rotor model.</span>
<span class="sd">        angle : float, str</span>
<span class="sd">            The orientation angle of the axis.</span>
<span class="sd">            Options are:</span>
<span class="sd">                float : angle in rad capture the response in a probe orientation;</span>
<span class="sd">                str : &quot;major&quot; to capture the response for the major axis;</span>
<span class="sd">                str : &quot;minor&quot; to capture the response for the minor axis.</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        major_axis_vector : np.ndarray</span>
<span class="sd">            major_axis_vector[0, :] = foward vector</span>
<span class="sd">            major_axis_vector[1, :] = backward vector</span>
<span class="sd">            major_axis_vector[2, :] = axis angle</span>
<span class="sd">            major_axis_vector[3, :] = axis vector response for the input angle</span>
<span class="sd">            major_axis_vector[4, :] = phase response for the input angle</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">link_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">link_nodes</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="n">major_axis_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="n">fix_dof</span> <span class="o">=</span> <span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ndof</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">link_nodes</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dofx</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">node</span> <span class="o">-</span> <span class="n">fix_dof</span>
        <span class="n">dofy</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">node</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fix_dof</span>

        <span class="c1"># Relative angle between probes (90°)</span>
        <span class="n">Rel_ang</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">):</span>

            <span class="c1"># Foward and Backward vectors</span>
            <span class="n">fow</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Rel_ang</span> <span class="o">*</span> <span class="n">response</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">back</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="n">Rel_ang</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="p">)</span>

            <span class="n">ang_fow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">fow</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ang_fow</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ang_fow</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="n">ang_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">back</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ang_back</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ang_back</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="s2">&quot;major&quot;</span><span class="p">:</span>
                <span class="c1"># Major axis angle</span>
                <span class="n">axis_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">ang_back</span> <span class="o">-</span> <span class="n">ang_fow</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">axis_angle</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                    <span class="n">axis_angle</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s2">&quot;minor&quot;</span><span class="p">:</span>
                <span class="c1"># Minor axis angle</span>
                <span class="n">axis_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">ang_back</span> <span class="o">-</span> <span class="n">ang_fow</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">axis_angle</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                    <span class="n">axis_angle</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">axis_angle</span> <span class="o">=</span> <span class="n">angle</span>

            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fow</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">back</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_angle</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="n">fow</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">axis_angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">back</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">axis_angle</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span>
                <span class="n">fow</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">axis_angle</span><span class="p">)</span> <span class="o">+</span> <span class="n">back</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">axis_angle</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">major_axis_vector</span>

    <span class="k">def</span> <span class="nf">_calculate_major_axis_per_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the major axis for each nodal orbit.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        major_axis_vector : np.ndarray</span>
<span class="sd">            major_axis_vector[0, :] = foward vector</span>
<span class="sd">            major_axis_vector[1, :] = backward vector</span>
<span class="sd">            major_axis_vector[2, :] = major axis angle</span>
<span class="sd">            major_axis_vector[3, :] = major axis vector for the maximum major axis angle</span>
<span class="sd">            major_axis_vector[4, :] = absolute values for major axes vectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>

        <span class="n">major_axis_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
            <span class="n">dofx</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">dofy</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># Relative angle between probes (90°)</span>
            <span class="n">Rel_ang</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Foward and Backward vectors</span>
            <span class="n">fow</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Rel_ang</span> <span class="o">*</span> <span class="n">response</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">back</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">idx</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="n">Rel_ang</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">idx</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="p">)</span>

            <span class="n">ang_fow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">fow</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ang_fow</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ang_fow</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="n">ang_back</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">back</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ang_back</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ang_back</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="c1"># Major axis angles</span>
            <span class="n">ang_maj_ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">ang_back</span> <span class="o">-</span> <span class="n">ang_fow</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="c1"># Adjusting points to the same quadrant</span>
            <span class="k">if</span> <span class="n">ang_maj_ax</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                <span class="n">ang_maj_ax</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fow</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">back</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ang_maj_ax</span>

        <span class="n">max_major_axis_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># fmt: off</span>
        <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">max_major_axis_angle</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">max_major_axis_angle</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>
            <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">major_axis_vector</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="c1"># fmt: on</span>

        <span class="k">return</span> <span class="n">major_axis_vector</span>

    <span class="k">def</span> <span class="nf">_calculate_bending_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the bending moment in X and Y directions.</span>

<span class="sd">        This method calculate forces and moments on nodal positions for a deflected</span>
<span class="sd">        shape configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Mx : array</span>
<span class="sd">            Bending Moment on X directon.</span>
<span class="sd">        My : array</span>
<span class="sd">            Bending Moment on Y directon.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forced_resp</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">])</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forced_resp</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">])</span>
        <span class="n">number_dof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>

        <span class="n">Mx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">My</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="n">mag</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">phase</span><span class="p">)</span>

        <span class="c1"># fmt: off</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">shaft_elements</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">el</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">Ie</span> <span class="o">/</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">],</span>
                <span class="p">[</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">+</span><span class="mi">2</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="o">+</span><span class="mi">4</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">],</span>
            <span class="p">])</span>
            <span class="n">response_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_l</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_l</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]],</span>
            <span class="p">])</span>

            <span class="n">Mx</span><span class="p">[[</span><span class="n">el</span><span class="o">.</span><span class="n">n_l</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">x</span> <span class="o">@</span> <span class="n">response_x</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

            <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">el</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">E</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">Ie</span> <span class="o">/</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="o">+</span><span class="mi">4</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="o">+</span><span class="mi">2</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">],</span>
                <span class="p">[</span><span class="o">+</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">L</span><span class="p">],</span>
            <span class="p">])</span>
            <span class="n">response_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_l</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]],</span>
                <span class="p">[</span><span class="n">mag</span><span class="p">[</span><span class="n">number_dof</span> <span class="o">*</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]],</span>
            <span class="p">])</span>
            <span class="n">My</span><span class="p">[[</span><span class="n">el</span><span class="o">.</span><span class="n">n_l</span><span class="p">,</span> <span class="n">el</span><span class="o">.</span><span class="n">n_r</span><span class="p">]]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">@</span> <span class="n">response_y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="c1"># fmt: on</span>

        <span class="k">return</span> <span class="n">Mx</span><span class="p">,</span> <span class="n">My</span>

<div class="viewcode-block" id="ForcedResponseResults.plot_deflected_shape_2d"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_deflected_shape_2d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_deflected_shape_2d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">speed</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the 2D deflected shape diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        rotor_length_units : str, optional</span>
<span class="sd">            Displacement units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the deflected shape</span>
<span class="sd">            plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data available for this speed value.&quot;</span><span class="p">)</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">maj_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_major_axis_per_speed</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span>
        <span class="n">maj_vect</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">maj_vect</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Major Axis&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Major_Axis_2d&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Nodal Position (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># plot center line</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">)),</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Major Axis Abs Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_deflected_shape_3d"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_deflected_shape_3d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_deflected_shape_3d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">speed</span><span class="p">,</span>
        <span class="n">samples</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the 3D deflected shape diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>
<span class="sd">        samples : int, optional</span>
<span class="sd">            Number of samples to generate the orbit for each node.</span>
<span class="sd">            Default is 101.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        rotor_length_units : str, optional</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the deflected shape</span>
<span class="sd">            plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data available for this speed value.&quot;</span><span class="p">)</span>

        <span class="n">unit_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">dimensionality</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">base_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported unit. Dimensionality options are &#39;[length]&#39;, &#39;[speed]&#39;, &#39;[acceleration]&#39;&quot;</span>
            <span class="p">)</span>

        <span class="n">mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">default_units</span><span class="p">[</span><span class="n">unit_type</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unbalance</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">number_dof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># orbit of a single revolution</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">speed</span><span class="p">,</span> <span class="n">samples</span><span class="p">)</span>
        <span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">),</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
            <span class="n">dofx</span> <span class="o">=</span> <span class="n">number_dof</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">dofy</span> <span class="o">=</span> <span class="n">number_dof</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="n">y</span> <span class="o">=</span> <span class="n">mag</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">speed</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">phase</span><span class="p">[</span><span class="n">dofx</span><span class="p">,</span> <span class="n">idx</span><span class="p">])</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">mag</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">speed</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">phase</span><span class="p">[</span><span class="n">dofy</span><span class="p">,</span> <span class="n">idx</span><span class="p">])</span>

            <span class="c1"># plot nodal orbit</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">x_pos</span><span class="p">[</span><span class="n">n</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;royalblue&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Orbit&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Orbit&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Position (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;X - Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Y - Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">z:.2e</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># plot major axis</span>
        <span class="n">maj_vect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_major_axis_per_speed</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">x_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">base_unit</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Major Axis&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Major_Axis&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Position (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;X - Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Y - Amplitude (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">z:.2e</span><span class="se">}}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># plot center line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># plot unbalance markers</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ub</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ub</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ub</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x_pos</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_pos</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)],</span> <span class="n">base_unit</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">Q_</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">)],</span> <span class="n">base_unit</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">),</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Unbalance&quot;</span><span class="p">,</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x_pos</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">0</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">)],</span> <span class="n">base_unit</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">Q_</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">maj_vect</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">)],</span> <span class="n">base_unit</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">amplitude_units</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;diamond&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;firebrick&quot;</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Unbalance&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Unbalance&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;Node: </span><span class="si">{}</span><span class="s2">&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Magnitude: </span><span class="si">{:.2e}</span><span class="s2">&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Phase: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">speed_str</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude - X (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
                <span class="n">zaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude - Y (</span><span class="si">{</span><span class="n">amplitude_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
            <span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deflected Shape&lt;br&gt;Speed = </span><span class="si">{</span><span class="n">speed_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_bending_moment"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_bending_moment">[docs]</a>    <span class="k">def</span> <span class="nf">plot_bending_moment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">speed</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">moment_units</span><span class="o">=</span><span class="s2">&quot;N*m&quot;</span><span class="p">,</span>
        <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the bending moment diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        moment_units : str, optional</span>
<span class="sd">            Moment units.</span>
<span class="sd">            Default is &#39;N*m&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is m.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the deflected shape</span>
<span class="sd">            plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">speed_range</span><span class="p">,</span> <span class="n">speed</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data available for this speed value.&quot;</span><span class="p">)</span>

        <span class="n">Mx</span><span class="p">,</span> <span class="n">My</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_bending_moment</span><span class="p">(</span><span class="n">speed</span><span class="o">=</span><span class="n">speed</span><span class="p">)</span>
        <span class="n">Mx</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">Mx</span><span class="p">,</span> <span class="s2">&quot;N*m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">moment_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">My</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">My</span><span class="p">,</span> <span class="s2">&quot;N*m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">moment_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">Mr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Mx</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">My</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">Mx</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bending Moment (X dir.) (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Mx&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Nodal Position: %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Mx (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">My</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bending Moment (Y dir.) (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;My&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Nodal Position: %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;My (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">Mr</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bending Moment (abs) (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Mr&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Nodal Position: %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Mr (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># plot center line</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">nodes_pos</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">),</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bending Moment (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">title_font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="ForcedResponseResults.plot_deflected_shape"><a class="viewcode-back" href="../../generated/results/ross.ForcedResponseResults.html#ross.ForcedResponseResults.plot_deflected_shape">[docs]</a>    <span class="k">def</span> <span class="nf">plot_deflected_shape</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">speed</span><span class="p">,</span>
        <span class="n">samples</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="n">amplitude_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">moment_units</span><span class="o">=</span><span class="s2">&quot;N*m&quot;</span><span class="p">,</span>
        <span class="n">shape2d_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">shape3d_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">bm_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">subplot_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot deflected shape diagrams.</span>

<span class="sd">        This method returns a subplot with:</span>
<span class="sd">            - 3D view deflected shape;</span>
<span class="sd">            - 2D view deflected shape - Major Axis;</span>
<span class="sd">            - Bending Moment Diagram;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        speed : float</span>
<span class="sd">            The rotor rotation speed. Must be an element from the speed_range argument</span>
<span class="sd">            passed to the class (rad/s).</span>
<span class="sd">        samples : int, optional</span>
<span class="sd">            Number of samples to generate the orbit for each node.</span>
<span class="sd">            Default is 101.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Frequency units.</span>
<span class="sd">            Default is &quot;rad/s&quot;</span>
<span class="sd">        amplitude_units : str, optional</span>
<span class="sd">            Units for the y axis.</span>
<span class="sd">            Acceptable units dimensionality are:</span>
<span class="sd">                &#39;[length]&#39; - Displays the displacement;</span>
<span class="sd">                &#39;[speed]&#39; - Displays the velocity;</span>
<span class="sd">                &#39;[acceleration]&#39; - Displays the acceleration.</span>
<span class="sd">            Default is &quot;m&quot; 0 to peak.</span>
<span class="sd">            To use peak to peak use the prefix &#39;pkpk_&#39; (e.g. pkpk_m)</span>
<span class="sd">        rotor_length_units : str, optional</span>
<span class="sd">            Rotor length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        moment_units : str</span>
<span class="sd">            Moment units.</span>
<span class="sd">            Default is &#39;N*m&#39;</span>
<span class="sd">        shape2d_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the 2D deflected shape</span>
<span class="sd">            plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        shape3d_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the 3D deflected shape</span>
<span class="sd">            plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        bm_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the bending moment</span>
<span class="sd">            diagram plot layout only (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>
<span class="sd">        subplot_kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...). This kwargs override &quot;mag_kwargs&quot; and</span>
<span class="sd">            &quot;phase_kwargs&quot; dictionaries.</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">            Plotly figure with Amplitude vs Frequency and Phase vs Frequency and</span>
<span class="sd">            polar Amplitude vs Phase plots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shape2d_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">shape2d_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">shape2d_kwargs</span><span class="p">)</span>
        <span class="n">shape3d_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">shape3d_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">shape3d_kwargs</span><span class="p">)</span>
        <span class="n">bm_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">bm_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">bm_kwargs</span><span class="p">)</span>
        <span class="n">subplot_kwargs</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">subplot_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">subplot_kwargs</span><span class="p">)</span>
        <span class="n">speed_str</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="c1"># fmt: off</span>
        <span class="n">fig0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_deflected_shape_2d</span><span class="p">(</span>
            <span class="n">speed</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="p">,</span> <span class="o">**</span><span class="n">shape2d_kwargs</span>
        <span class="p">)</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_deflected_shape_3d</span><span class="p">(</span>
            <span class="n">speed</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">amplitude_units</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="p">,</span> <span class="o">**</span><span class="n">shape3d_kwargs</span>
        <span class="p">)</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_bending_moment</span><span class="p">(</span>
            <span class="n">speed</span><span class="p">,</span> <span class="n">frequency_units</span><span class="p">,</span> <span class="n">moment_units</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="p">,</span> <span class="o">**</span><span class="n">bm_kwargs</span>
        <span class="p">)</span>
        <span class="c1"># fmt: on</span>

        <span class="n">subplots</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[[{},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;scene&quot;</span><span class="p">,</span> <span class="s2">&quot;rowspan&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}],</span> <span class="p">[{},</span> <span class="kc">None</span><span class="p">]],</span>
            <span class="n">shared_xaxes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig0</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig1</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">fig2</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]:</span>
            <span class="n">subplots</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">subplots</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig0</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">subplots</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">bgcolor</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">bgcolor</span><span class="p">,</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">xaxis</span><span class="p">,</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">yaxis</span><span class="p">,</span>
                <span class="n">zaxis</span><span class="o">=</span><span class="n">fig1</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">zaxis</span><span class="p">,</span>
                <span class="n">domain</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mf">0.47</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
            <span class="p">),</span>
            <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deflected Shape&lt;br&gt;Speed = </span><span class="si">{</span><span class="n">speed_str</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">subplot_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">subplots</span></div></div>


<div class="viewcode-block" id="StaticResults"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults">[docs]</a><span class="k">class</span> <span class="nc">StaticResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Static Analysis.</span>

<span class="sd">    This class plots free-body diagram, deformed shaft, shearing</span>
<span class="sd">    force diagram and bending moment diagram.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    deformation : array</span>
<span class="sd">        shaft displacement in y direction.</span>
<span class="sd">    Vx : array</span>
<span class="sd">        shearing force array.</span>
<span class="sd">    Bm : array</span>
<span class="sd">        bending moment array.</span>
<span class="sd">    w_shaft : dataframe</span>
<span class="sd">        shaft dataframe</span>
<span class="sd">    disk_forces : dict</span>
<span class="sd">        Indicates the force exerted by each disk.</span>
<span class="sd">    bearing_forces : dict</span>
<span class="sd">        Relates the static force at each node due to the bearing reaction forces.</span>
<span class="sd">    nodes : list</span>
<span class="sd">        list of nodes numbers.</span>
<span class="sd">    nodes_pos : list</span>
<span class="sd">        list of nodes positions.</span>
<span class="sd">    Vx_axis : array</span>
<span class="sd">        X axis for displaying shearing force and bending moment.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Plotly graph_objects.Figure()</span>
<span class="sd">        Plotly figure with Static Analysis plots depending on which method</span>
<span class="sd">        is called.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="StaticResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">deformation</span><span class="p">,</span>
        <span class="n">Vx</span><span class="p">,</span>
        <span class="n">Bm</span><span class="p">,</span>
        <span class="n">w_shaft</span><span class="p">,</span>
        <span class="n">disk_forces</span><span class="p">,</span>
        <span class="n">bearing_forces</span><span class="p">,</span>
        <span class="n">nodes</span><span class="p">,</span>
        <span class="n">nodes_pos</span><span class="p">,</span>
        <span class="n">Vx_axis</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deformation</span> <span class="o">=</span> <span class="n">deformation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vx</span> <span class="o">=</span> <span class="n">Vx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bm</span> <span class="o">=</span> <span class="n">Bm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_shaft</span> <span class="o">=</span> <span class="n">w_shaft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disk_forces</span> <span class="o">=</span> <span class="n">disk_forces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bearing_forces</span> <span class="o">=</span> <span class="n">bearing_forces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">nodes_pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vx_axis</span> <span class="o">=</span> <span class="n">Vx_axis</span></div>

<div class="viewcode-block" id="StaticResults.plot_deformation"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults.plot_deformation">[docs]</a>    <span class="k">def</span> <span class="nf">plot_deformation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">deformation_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the shaft static deformation.</span>

<span class="sd">        This method plots:</span>
<span class="sd">            deformed shaft</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        deformation_units : str</span>
<span class="sd">            Deformation units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">shaft_end</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">sublist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">])</span>
        <span class="n">shaft_end</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">shaft_end</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="c1"># fig - plot centerline</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">,</span> <span class="mf">1.01</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">deformation</span><span class="p">,</span> <span class="n">Vx</span><span class="p">,</span> <span class="n">Bm</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">,</span> <span class="n">Vx_axis</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deformation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vx_axis</span>
        <span class="p">):</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">deformation</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">deformation_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line_shape</span><span class="o">=</span><span class="s2">&quot;spline&quot;</span><span class="p">,</span>
                    <span class="n">line_smoothing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Displacement (</span><span class="si">{</span><span class="n">deformation_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Deformation (</span><span class="si">{</span><span class="n">deformation_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Static Deformation&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="StaticResults.plot_free_body_diagram"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults.plot_free_body_diagram">[docs]</a>    <span class="k">def</span> <span class="nf">plot_free_body_diagram</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">force_units</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the rotor free-body diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force_units : str</span>
<span class="sd">            Force units.</span>
<span class="sd">            Default is &#39;N&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. plot_bgcolor=&quot;white&quot;, ...).</span>
<span class="sd">            *See Plotly Python make_subplot Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        subplots : Plotly graph_objects.make_subplots()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">2</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
                <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
                <span class="n">cols</span><span class="o">=</span><span class="n">cols</span><span class="p">,</span>
                <span class="n">subplot_titles</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;Free-Body Diagram - Shaft </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">))</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">y_start</span> <span class="o">=</span> <span class="mf">5.0</span>
        <span class="k">for</span> <span class="n">nodes_pos</span><span class="p">,</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">row</span> <span class="o">=</span> <span class="n">j</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">)),</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">y_start</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">),</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># fig - plot arrows indicating shaft weight distribution</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:.1f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_shaft</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">force_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
            <span class="n">ini</span> <span class="o">=</span> <span class="n">nodes_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fin</span> <span class="o">=</span> <span class="n">nodes_pos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">arrows_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ini</span><span class="p">,</span> <span class="mf">1.01</span> <span class="o">*</span> <span class="n">fin</span><span class="p">,</span> <span class="p">(</span><span class="n">fin</span> <span class="o">-</span> <span class="n">ini</span><span class="p">)</span> <span class="o">/</span> <span class="mf">5.0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">arrows_list</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">axref</span><span class="o">=</span><span class="s2">&quot;x</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">ayref</span><span class="o">=</span><span class="s2">&quot;y</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">arrowhead</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">arrowsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">arrowwidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">arrowcolor</span><span class="o">=</span><span class="s2">&quot;DimGray&quot;</span><span class="p">,</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">ay</span><span class="o">=</span><span class="n">y_start</span> <span class="o">*</span> <span class="mf">1.08</span><span class="p">,</span>
                    <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                    <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_start</span><span class="p">,</span>
                <span class="n">xref</span><span class="o">=</span><span class="s2">&quot;x</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">yref</span><span class="o">=</span><span class="s2">&quot;y</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">xshift</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
                <span class="n">yshift</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft weight = </span><span class="si">{</span><span class="n">text</span><span class="si">}{</span><span class="n">force_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">align</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
                <span class="n">showarrow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># plot bearing reaction forces</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bearing_forces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">Q_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">force_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">var</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">node</span><span class="p">)],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">axref</span><span class="o">=</span><span class="s2">&quot;x</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">ayref</span><span class="o">=</span><span class="s2">&quot;y</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fb = </span><span class="si">{</span><span class="n">text</span><span class="si">}{</span><span class="n">force_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">textangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">arrowhead</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">arrowsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">arrowwidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">arrowcolor</span><span class="o">=</span><span class="s2">&quot;DarkSalmon&quot;</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">node</span><span class="p">)],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                        <span class="n">ay</span><span class="o">=</span><span class="n">var</span> <span class="o">*</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">y_start</span><span class="p">,</span>
                        <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                        <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># plot disk forces</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">disk_forces</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">_</span><span class="p">,</span> <span class="n">node</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
                <span class="n">node</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="o">-</span><span class="n">Q_</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">force_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_annotation</span><span class="p">(</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">node</span><span class="p">)],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">axref</span><span class="o">=</span><span class="s2">&quot;x</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">ayref</span><span class="o">=</span><span class="s2">&quot;y</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
                        <span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Fd = </span><span class="si">{</span><span class="n">text</span><span class="si">}{</span><span class="n">force_units</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">textangle</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span>
                        <span class="n">showarrow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">arrowhead</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">arrowsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">arrowwidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">arrowcolor</span><span class="o">=</span><span class="s2">&quot;FireBrick&quot;</span><span class="p">,</span>
                        <span class="n">ax</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">node</span><span class="p">)],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
                        <span class="o">.</span><span class="n">m</span><span class="p">,</span>
                        <span class="n">ay</span><span class="o">=</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">y_start</span><span class="p">,</span>
                        <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                        <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
                <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span>
            <span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
                <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gridcolor</span><span class="o">=</span><span class="s2">&quot;lightgray&quot;</span><span class="p">,</span> <span class="n">showline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span>
            <span class="p">)</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="StaticResults.plot_shearing_force"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults.plot_shearing_force">[docs]</a>    <span class="k">def</span> <span class="nf">plot_shearing_force</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">force_units</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the rotor shearing force diagram.</span>

<span class="sd">        This method plots:</span>
<span class="sd">            shearing force diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force_units : str</span>
<span class="sd">            Force units.</span>
<span class="sd">            Default is &#39;N&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">shaft_end</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">sublist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">]),</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
            <span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>

        <span class="c1"># fig - plot centerline</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">Vx</span><span class="p">,</span> <span class="n">Vx_axis</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Vx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vx_axis</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">Vx_axis</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">Vx</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">force_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Shearing Force (</span><span class="si">{</span><span class="n">force_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2f</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Force (</span><span class="si">{</span><span class="n">force_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Shearing Force Diagram&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="StaticResults.plot_bending_moment"><a class="viewcode-back" href="../../generated/results/ross.StaticResults.html#ross.StaticResults.plot_bending_moment">[docs]</a>    <span class="k">def</span> <span class="nf">plot_bending_moment</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">moment_units</span><span class="o">=</span><span class="s2">&quot;N*m&quot;</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the rotor bending moment diagram.</span>

<span class="sd">        This method plots:</span>
<span class="sd">            bending moment diagram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        moment_units : str, optional</span>
<span class="sd">            Moment units.</span>
<span class="sd">            Default is &#39;N*m&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            Plotly figure with the bending moment diagram plot</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            Plotly figure with the bending moment diagram plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">shaft_end</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="n">sublist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">]),</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span>
            <span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>

        <span class="c1"># fig - plot centerline</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">shaft_end</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">Bm</span><span class="p">,</span> <span class="n">nodes_pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vx_axis</span><span class="p">):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">Bm</span><span class="p">,</span> <span class="s2">&quot;N*m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">moment_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line_shape</span><span class="o">=</span><span class="s2">&quot;spline&quot;</span><span class="p">,</span>
                    <span class="n">line_smoothing</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Shaft </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Bending Moment (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2f</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bending Moment (</span><span class="si">{</span><span class="n">moment_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Bending Moment Diagram&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="SummaryResults"><a class="viewcode-back" href="../../generated/results/ross.SummaryResults.html#ross.SummaryResults">[docs]</a><span class="k">class</span> <span class="nc">SummaryResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots rotor summary.</span>

<span class="sd">    This class aims to present a summary of the main parameters and attributes</span>
<span class="sd">    from a rotor model. The data is presented in a table format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    df_shaft: dataframe</span>
<span class="sd">        shaft dataframe</span>
<span class="sd">    df_disks: dataframe</span>
<span class="sd">        disks dataframe</span>
<span class="sd">    df_bearings: dataframe</span>
<span class="sd">        bearings dataframe</span>
<span class="sd">    brg_forces: list</span>
<span class="sd">        list of reaction forces on bearings</span>
<span class="sd">    nodes_pos:  list</span>
<span class="sd">        list of nodes axial position</span>
<span class="sd">    CG: float</span>
<span class="sd">        rotor center of gravity</span>
<span class="sd">    Ip: float</span>
<span class="sd">        rotor total moment of inertia around the center line</span>
<span class="sd">    tag: str</span>
<span class="sd">        rotor&#39;s tag</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Plotly graph_objects.make_subplots()</span>
<span class="sd">        The figure object with the tables plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SummaryResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.SummaryResults.html#ross.SummaryResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">df_shaft</span><span class="p">,</span> <span class="n">df_disks</span><span class="p">,</span> <span class="n">df_bearings</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">,</span> <span class="n">brg_forces</span><span class="p">,</span> <span class="n">CG</span><span class="p">,</span> <span class="n">Ip</span><span class="p">,</span> <span class="n">tag</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span> <span class="o">=</span> <span class="n">df_shaft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span> <span class="o">=</span> <span class="n">df_disks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span> <span class="o">=</span> <span class="n">df_bearings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brg_forces</span> <span class="o">=</span> <span class="n">brg_forces</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CG</span> <span class="o">=</span> <span class="n">CG</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span> <span class="o">=</span> <span class="n">Ip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">tag</span></div>

<div class="viewcode-block" id="SummaryResults.plot"><a class="viewcode-back" href="../../generated/results/ross.SummaryResults.html#ross.SummaryResults.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot the summary table.</span>

<span class="sd">        This method plots:</span>
<span class="sd">            Table with summary of rotor parameters and attributes</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.make_subplots()</span>
<span class="sd">            The figure object with the tables plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;material&quot;</span><span class="p">]]</span>

        <span class="n">shaft_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Shaft number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;shaft_number&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Left station&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;n_l&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Right station&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;n_r&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Elem number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;_n&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Beam left loc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;nodes_pos_l&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Axial CG Pos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;axial_cg_pos&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Beam right loc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;nodes_pos_r&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Material&quot;</span><span class="p">:</span> <span class="n">materials</span><span class="p">,</span>
            <span class="s2">&quot;Mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">),</span>
            <span class="s2">&quot;Inertia&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;Im&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="n">rotor_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">],</span>
            <span class="s2">&quot;Starting node&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;n_l&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s2">&quot;Ending node&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;n_r&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
            <span class="s2">&quot;Starting point&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;nodes_pos_l&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s2">&quot;Total lenght&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;nodes_pos_r&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
            <span class="s2">&quot;CG&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CG</span><span class="p">)],</span>
            <span class="s2">&quot;Ip&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">{:.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">)],</span>
            <span class="s2">&quot;Rotor Mass&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_shaft</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]))</span>
            <span class="p">],</span>
        <span class="p">}</span>

        <span class="n">disk_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Shaft number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;shaft_number&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Node&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Nodal Position&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;Mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;m&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">),</span>
            <span class="s2">&quot;Ip&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;Ip&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="n">bearing_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Tag&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Shaft number&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;shaft_number&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Node&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">],</span>
            <span class="s2">&quot;N_link&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;n_link&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Nodal Position&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;Bearing force&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brg_forces</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
        <span class="p">}</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
            <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">specs</span><span class="o">=</span><span class="p">[</span>
                <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">}],</span>
                <span class="p">[{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;table&quot;</span><span class="p">}],</span>
            <span class="p">],</span>
            <span class="n">subplot_titles</span><span class="o">=</span><span class="p">[</span>
                <span class="s2">&quot;Rotor data&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Shaft Element data&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Disk Element data&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Bearing Element data&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span> <span class="s2">&quot;#c4d9ed&quot;</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rotor_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f4060&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f4060&quot;</span><span class="p">),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">rotor_data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f4060&quot;</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cell_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">materials</span><span class="p">))]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">shaft_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">shaft_data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#12263b&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c4d9ed&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cell_colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shaft_data</span><span class="p">)]),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cell_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_disks</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]))]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">disk_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">disk_data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#12263b&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c4d9ed&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cell_colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shaft_data</span><span class="p">)]),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">cell_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_bearings</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">]))]</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
                <span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">bearing_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1e4162&quot;</span><span class="p">),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">values</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">bearing_data</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>
                    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#12263b&quot;</span><span class="p">),</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#c4d9ed&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">),</span>
                    <span class="n">fill</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cell_colors</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shaft_data</span><span class="p">)]),</span>
                    <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">height</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="ConvergenceResults"><a class="viewcode-back" href="../../generated/results/ross.ConvergenceResults.html#ross.ConvergenceResults">[docs]</a><span class="k">class</span> <span class="nc">ConvergenceResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Convergence Analysis.</span>

<span class="sd">    This class plots:</span>
<span class="sd">        Natural Frequency vs Number of Elements</span>
<span class="sd">        Relative Error vs Number of Elements</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    el_num : array</span>
<span class="sd">        Array with number of elements in each iteraction</span>
<span class="sd">    eigv_arr : array</span>
<span class="sd">        Array with the n&#39;th natural frequency in each iteraction</span>
<span class="sd">    error_arr : array</span>
<span class="sd">        Array with the relative error in each iteraction</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Plotly graph_objects.make_subplots()</span>
<span class="sd">        The figure object with the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ConvergenceResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.ConvergenceResults.html#ross.ConvergenceResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">el_num</span><span class="p">,</span> <span class="n">eigv_arr</span><span class="p">,</span> <span class="n">error_arr</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">el_num</span> <span class="o">=</span> <span class="n">el_num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eigv_arr</span> <span class="o">=</span> <span class="n">eigv_arr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_arr</span> <span class="o">=</span> <span class="n">error_arr</span></div>

<div class="viewcode-block" id="ConvergenceResults.plot"><a class="viewcode-back" href="../../generated/results/ross.ConvergenceResults.html#ross.ConvergenceResults.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot convergence results.</span>

<span class="sd">        This method plots:</span>
<span class="sd">            Natural Frequency vs Number of Elements</span>
<span class="sd">            Relative Error vs Number of Elements</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : Plotly graph_objects.make_subplots()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.make_subplots()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
                <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">subplot_titles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Frequency Evaluation&quot;</span><span class="p">,</span> <span class="s2">&quot;Relative Error Evaluation&quot;</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="c1"># plot Frequency vs number of elements</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">el_num</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">eigv_arr</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;Number of Elements: %</span><span class="si">{x:.2f}</span><span class="s2">&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Frequency: %</span><span class="si">{y:.0f}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Number of Elements&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Frequency&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># plot Error vs number of elements</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">el_num</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">error_arr</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;Number of Elements: %</span><span class="si">{x:.2f}</span><span class="s2">&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Relative Error: %</span><span class="si">{y:.0f}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Number of Elements&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Relative Error (%)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<div class="viewcode-block" id="TimeResponseResults"><a class="viewcode-back" href="../../generated/results/ross.TimeResponseResults.html#ross.TimeResponseResults">[docs]</a><span class="k">class</span> <span class="nc">TimeResponseResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Time Response Analysis.</span>

<span class="sd">    This class takes the results from time response analysis and creates a</span>
<span class="sd">    plots given a force and a time. It&#39;s possible to select through a time response for</span>
<span class="sd">    a single DoF, an orbit response for a single node or display orbit response for all</span>
<span class="sd">    nodes.</span>
<span class="sd">    The plot type options are:</span>
<span class="sd">        - 1d: plot time response for given probes.</span>
<span class="sd">        - 2d: plot orbit of a selected node of a rotor system.</span>
<span class="sd">        - 3d: plot orbits for each node on the rotor system in a 3D view.</span>

<span class="sd">    plot_1d: input probes.</span>
<span class="sd">    plot_2d: input a node.</span>
<span class="sd">    plot_3d: no need to input probes or node.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rotor : Rotor.object</span>
<span class="sd">        The Rotor object</span>
<span class="sd">    t : array</span>
<span class="sd">        Time values for the output.</span>
<span class="sd">    yout : array</span>
<span class="sd">        System response.</span>
<span class="sd">    xout : array</span>
<span class="sd">        Time evolution of the state vector.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : Plotly graph_objects.Figure()</span>
<span class="sd">        The figure object with the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TimeResponseResults.__init__"><a class="viewcode-back" href="../../generated/results/ross.TimeResponseResults.html#ross.TimeResponseResults.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotor</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">yout</span><span class="p">,</span> <span class="n">xout</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yout</span> <span class="o">=</span> <span class="n">yout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xout</span> <span class="o">=</span> <span class="n">xout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span> <span class="o">=</span> <span class="n">rotor</span></div>

<div class="viewcode-block" id="TimeResponseResults.plot_1d"><a class="viewcode-back" href="../../generated/results/ross.TimeResponseResults.html#ross.TimeResponseResults.plot_1d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_1d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">probe</span><span class="p">,</span>
        <span class="n">probe_units</span><span class="o">=</span><span class="s2">&quot;rad&quot;</span><span class="p">,</span>
        <span class="n">displacement_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span>
        <span class="n">time_units</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot time response.</span>

<span class="sd">        This method plots the time response given a tuple of probes with their nodes</span>
<span class="sd">        and orientations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        probe : list of tuples</span>
<span class="sd">            List with tuples (node, orientation angle, tag).</span>
<span class="sd">            node : int</span>
<span class="sd">                indicate the node where the probe is located.</span>
<span class="sd">            orientation : float</span>
<span class="sd">                probe orientation angle about the shaft. The 0 refers to +X direction.</span>
<span class="sd">            tag : str, optional</span>
<span class="sd">                probe tag to be displayed at the legend.</span>
<span class="sd">        probe_units : str, option</span>
<span class="sd">            Units for probe orientation.</span>
<span class="sd">            Default is &quot;rad&quot;.</span>
<span class="sd">        displacement_units : str, optional</span>
<span class="sd">            Displacement units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        time_units : str</span>
<span class="sd">            Time units.</span>
<span class="sd">            Default is &#39;s&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">link_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">link_nodes</span>
        <span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">probe</span><span class="p">):</span>
            <span class="n">fix_dof</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ndof</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">link_nodes</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">dofx</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fix_dof</span>
            <span class="n">dofy</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fix_dof</span>

            <span class="n">angle</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">probe_units</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;rad&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

            <span class="c1"># fmt: off</span>
            <span class="n">operator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)],</span>
                 <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]]</span>
            <span class="p">)</span>

            <span class="n">_probe_resp</span> <span class="o">=</span> <span class="n">operator</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">dofx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">dofy</span><span class="p">]))</span>
            <span class="n">probe_resp</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">_probe_resp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                <span class="n">_probe_resp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="p">)</span>
            <span class="c1"># fmt: on</span>

            <span class="n">probe_resp</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">probe_resp</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">probe_tag</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Probe </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - Node </span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">time_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">probe_resp</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="n">probe_tag</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time (</span><span class="si">{</span><span class="n">time_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Time (</span><span class="si">{</span><span class="n">time_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="TimeResponseResults.plot_2d"><a class="viewcode-back" href="../../generated/results/ross.TimeResponseResults.html#ross.TimeResponseResults.plot_2d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">displacement_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot orbit response (2D).</span>

<span class="sd">        This function will take a rotor object and plot its orbit response using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        node: int, optional</span>
<span class="sd">            Selected node to plot orbit.</span>
<span class="sd">        displacement_units : str, optional</span>
<span class="sd">            Displacement units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">link_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">link_nodes</span>
        <span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>

        <span class="n">fix_dof</span> <span class="o">=</span> <span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="n">nodes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ndof</span> <span class="o">//</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">link_nodes</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">dofx</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">node</span> <span class="o">-</span> <span class="n">fix_dof</span>
        <span class="n">dofy</span> <span class="o">=</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">node</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">fix_dof</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">dofx</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">dofy</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Orbit&quot;</span><span class="p">,</span>
                <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;Orbit&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;X - Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Y - Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&quot;</span>
                <span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">) - X direction&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">) - Y direction&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Response for node </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">node</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div>

<div class="viewcode-block" id="TimeResponseResults.plot_3d"><a class="viewcode-back" href="../../generated/results/ross.TimeResponseResults.html#ross.TimeResponseResults.plot_3d">[docs]</a>    <span class="k">def</span> <span class="nf">plot_3d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">displacement_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">rotor_length_units</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot orbit response (3D).</span>

<span class="sd">        This function will take a rotor object and plot its orbit response using Plotly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        displacement_units : str</span>
<span class="sd">            Displacement units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        rotor_length_units : str</span>
<span class="sd">            Rotor Length units.</span>
<span class="sd">            Default is &#39;m&#39;.</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. hoverlabel_align=&quot;center&quot;, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodes_pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes_pos</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">ndof</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotor</span><span class="o">.</span><span class="n">number_dof</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">x_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">nodes_pos</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">x_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">n</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">z</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="n">ndof</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">displacement_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">tableau_colors</span><span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">]),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mean&quot;</span><span class="p">,</span>
                    <span class="n">legendgroup</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Nodal Position (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2f</span><span class="se">}}</span><span class="s2">&lt;br&gt;X - Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Y - Amplitude (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">z:.2e</span><span class="se">}}</span><span class="s2">&quot;</span>
                    <span class="p">),</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># plot center line</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">))</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">Q_</span><span class="p">(</span><span class="n">nodes_pos</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rotor_length_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                <span class="n">z</span><span class="o">=</span><span class="n">line</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
            <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Rotor Length (</span><span class="si">{</span><span class="n">rotor_length_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
                <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude - X (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
                <span class="n">zaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Amplitude - Y (</span><span class="si">{</span><span class="n">displacement_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)),</span>
            <span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span></div></div>


<span class="k">class</span> <span class="nc">UCSResults</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for UCS Analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stiffness_range : tuple, optional</span>
<span class="sd">        Tuple with (start, end) for stiffness range.</span>
<span class="sd">    stiffness_log : tuple, optional</span>
<span class="sd">        Evenly numbers spaced evenly on a log scale to create a better visualization</span>
<span class="sd">        (see np.logspace).</span>
<span class="sd">    wn : array</span>
<span class="sd">        Undamped natural frequencies array.</span>
<span class="sd">    bearing : ross.BearingElement</span>
<span class="sd">        Bearing used in the calculation.</span>
<span class="sd">    intersection_points : array</span>
<span class="sd">        Points where there is a intersection between undamped natural frequency and</span>
<span class="sd">        the bearing stiffness.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stiffness_range</span><span class="p">,</span> <span class="n">stiffness_log</span><span class="p">,</span> <span class="n">wn</span><span class="p">,</span> <span class="n">bearing</span><span class="p">,</span> <span class="n">intersection_points</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stiffness_range</span> <span class="o">=</span> <span class="n">stiffness_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stiffness_log</span> <span class="o">=</span> <span class="n">stiffness_log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wn</span> <span class="o">=</span> <span class="n">wn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bearing</span> <span class="o">=</span> <span class="n">bearing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intersection_points</span> <span class="o">=</span> <span class="n">intersection_points</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stiffness_units</span><span class="o">=</span><span class="s2">&quot;N/m&quot;</span><span class="p">,</span>
        <span class="n">frequency_units</span><span class="o">=</span><span class="s2">&quot;rad/s&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot undamped critical speed map.</span>

<span class="sd">        This method will plot the undamped critical speed map for a given range</span>
<span class="sd">        of stiffness values. If the range is not provided, the bearing</span>
<span class="sd">        stiffness at rated speed will be used to create a range.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        stiffness_units : str, optional</span>
<span class="sd">            Units for the x axis.</span>
<span class="sd">            Default is N/m.</span>
<span class="sd">        frequency_units : str, optional</span>
<span class="sd">            Units for th y axis.</span>
<span class="sd">            Default is rad/s</span>
<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stiffness_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stiffness_log</span>
        <span class="n">rotor_wn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wn</span>
        <span class="n">bearing0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bearing</span>
        <span class="n">intersection_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intersection_points</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="c1"># convert to desired units</span>
        <span class="n">stiffness_log</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">stiffness_log</span><span class="p">,</span> <span class="s2">&quot;N/m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stiffness_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">rotor_wn</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">rotor_wn</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="s2">&quot;N/m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stiffness_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>
        <span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>
        <span class="n">bearing_kxx_stiffness</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="n">bearing0</span><span class="o">.</span><span class="n">kxx</span><span class="o">.</span><span class="n">interpolated</span><span class="p">(</span><span class="n">bearing0</span><span class="o">.</span><span class="n">frequency</span><span class="p">),</span> <span class="s2">&quot;N/m&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stiffness_units</span><span class="p">)</span>
            <span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>
        <span class="n">bearing_kyy_stiffness</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">Q_</span><span class="p">(</span><span class="n">bearing0</span><span class="o">.</span><span class="n">kyy</span><span class="o">.</span><span class="n">interpolated</span><span class="p">(</span><span class="n">bearing0</span><span class="o">.</span><span class="n">frequency</span><span class="p">),</span> <span class="s2">&quot;N/m&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">stiffness_units</span><span class="p">)</span>
            <span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>
        <span class="n">bearing_frequency</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">bearing0</span><span class="o">.</span><span class="n">frequency</span><span class="p">,</span> <span class="s2">&quot;rad/s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">frequency_units</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rotor_wn</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">stiffness_log</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">rotor_wn</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span>
                <span class="n">y</span><span class="o">=</span><span class="n">intersection_points</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle-open-dot&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Stiffness (</span><span class="si">{</span><span class="n">stiffness_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">x:.2e</span><span class="se">}}</span><span class="s2">&lt;br&gt;Frequency (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">): %</span><span class="se">{{</span><span class="s2">y:.2f</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">bearing_kxx_stiffness</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">bearing_frequency</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Kxx&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">bearing_kyy_stiffness</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">bearing_frequency</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dashdot&quot;</span><span class="p">),</span>
                <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Kyy&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Bearing Stiffness (</span><span class="si">{</span><span class="n">stiffness_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
            <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Critical Speed (</span><span class="si">{</span><span class="n">frequency_units</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
            <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Undamped Critical Speed Map&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span>


<span class="k">class</span> <span class="nc">Level1Results</span><span class="p">(</span><span class="n">Results</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class used to store results and provide plots for Level 1 Stability Analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    stiffness_range : array</span>
<span class="sd">        Stiffness array used in the calculation.</span>
<span class="sd">    log_dec : array</span>
<span class="sd">        Calculated log dec array for each cross coupling.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stiffness_range</span><span class="p">,</span> <span class="n">log_dec</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stiffness_range</span> <span class="o">=</span> <span class="n">stiffness_range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span> <span class="o">=</span> <span class="n">log_dec</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot level 1 stability analysis.</span>

<span class="sd">        This method will plot the stability 1 analysis for a</span>
<span class="sd">        given stiffness range.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fig : Plotly graph_objects.Figure</span>
<span class="sd">            The figure object with the plot.</span>

<span class="sd">        kwargs : optional</span>
<span class="sd">            Additional key word arguments can be passed to change the plot layout only</span>
<span class="sd">            (e.g. width=1000, height=800, ...).</span>
<span class="sd">            *See Plotly Python Figure Reference for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : Plotly graph_objects.Figure()</span>
<span class="sd">            The figure object with the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

        <span class="n">stiffness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stiffness_range</span>
        <span class="n">log_dec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dec</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">stiffness</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="n">log_dec</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">hovertemplate</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Stiffness: %</span><span class="si">{x:.2e}</span><span class="s2">&lt;br&gt;&quot;</span> <span class="o">+</span> <span class="s2">&quot;Log Dec: %</span><span class="si">{y:.2f}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span>
            <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Applied Cross Coupled Stiffness&quot;</span><span class="p">,</span> <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span>
        <span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Log Dec&quot;</span><span class="p">,</span> <span class="n">exponentformat</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Level 1 stability analysis&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

    </div>
      
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Team ROSS.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.1.<br/>
    </p>
  </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-157532410-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-157532410-1');
</script>

  </body>
</html>